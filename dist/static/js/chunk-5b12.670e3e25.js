(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5b12"],{GiAY:function(e,t,a){"use strict";a.d(t,"c",function(){return l}),a.d(t,"a",function(){return i}),a.d(t,"b",function(){return n});var s=a("t3Un");function l(e){return Object(s.a)({url:"/api/sys/office/list",method:"get",params:{id:e}})}function i(e){return Object(s.a)({url:"/api/sys/office/childs",method:"get",params:{pid:e}})}function n(e){return Object(s.a)({url:"/api/res/management/loweroffice",method:"get",params:e})}},Z93X:function(e,t,a){"use strict";a.r(t);var s=a("gDS+"),l=a.n(s),i=a("t3Un");function n(e){return Object(i.a)({url:"/api/ass/assOrgTemplateItem/findsettemplateitemlist",method:"get",params:e})}function o(e){return Object(i.a)({url:"/api/ass/assOrgTemplateItem/score/list",method:"get",params:e})}var r=a("GiAY"),c={components:{},data:function(){return{aaaaaa:"",v:{loading:!1},list:null,scorelist:null,addVisible:!1,editVisible:!1,settingVisible:!1,popoverVisible:!1,value2:null,value3:null,yearvalue:"",monthvalue:"",yearvalue2:"",monthvalue2:"",scoreVisible:!1,scoreloading:null,totalscore:[],query:{total:0,pageNo:1,pageSize:10,search:void 0,type:"5"},proTaskFrom:{id:null,name:null,content:null,score:null,standard:null},condition:{office:null,year:null,month:null},idvalue:[],selectionitems:null,options:[]}},created:function(){this.getarealist()},methods:{getarealist:function(){var e=this;Object(r.b)().then(function(t){e.options=t.data.list})},edit:function(e){alert("修改windows")},yearselection:function(e){var t=this,a=new Date,s=a.getFullYear();if(this.yearvalue>s)this.yearvalue=null,this.monthvalue=null,this.$message({message:"超出当前系统时间",type:"warning"});else{this.condition.year=e;var l=a.getMonth()+1;this.monthvalue=l+"月",this.condition.month=l.toString(),n(this.condition).then(function(e){t.list=e.data.list,t.$message({message:"查询成功",type:"success"})})}},monthselection:function(e){var t=this,a=new Date,s=a.getMonth()+1;if(this.monthvalue>s)this.yearvalue=null,this.monthvalue=null,this.$message({message:"超出当前系统时间",type:"warning"});else{this.condition.month=e;var l=a.getFullYear();this.yearvalue=l+"年",n(this.condition).then(function(e){t.list=e.data.list,t.$message({message:"查询成功",type:"success"})})}},yearselection2:function(e){var t=this,a=new Date,s=a.getFullYear();if(this.yearvalue2>s)this.yearvalue2=null,this.monthvalue2=null,this.$message({message:"超出当前系统时间",type:"warning"});else{this.condition.year=e;var l=a.getMonth()+1;this.monthvalue2=l+"月",this.condition.month=l.toString(),o(this.condition).then(function(e){t.scorelist=e.data.list,t.$message({message:"模板查询成功",type:"success"})})}},monthselection2:function(e){var t=this,a=new Date,s=a.getMonth()+1;if(this.monthvalue2>s)this.yearvalue2=null,this.monthvalue2=null,this.$message({message:"超出当前系统时间",type:"warning"});else{this.condition.month=e;var l=a.getFullYear();this.yearvalue2=l+"年",o(this.condition).then(function(e){t.scorelist=e.data.list,t.$message({message:"模板查询成功",type:"success"})})}},assessmentchange:function(e){this.multipleSelection=e},assitemchange:function(e){this.multipleSelection=e},assscore:function(){var e=this;this.scoreVisible=!0,this.scoreloading=!0;var t=new Date;o({year:t.getFullYear(),month:t.getMonth()+1}).then(function(t){e.scoreloading=!1,e.scorelist=t.data.list,console.log("this.scorelist",e.scorelist)})},getasslist:function(){var e=this;this.settingVisible=!0,n().then(function(t){e.list=t.data.list})},addassBtn:function(){var e=this.totalscore[2];100==(e=e.slice(0,3))?this.$message({message:"当前总分达到100分,无法继续添加",type:"warning"}):(this.addVisible=!0,this.proTaskFrom=[])},editassBtn:function(){null==this.selectionitems?this.$message({message:"请选择编辑项",type:"error"}):(console.log("this.proTaskFrom:::",this.selectionitems),this.editVisible=!0,this.proTaskFrom=this.selectionitems)},delassBtn:function(){var e=this;null==this.selectionitems?this.$message({message:"请选择删除项",type:"error"}):function(e){return Object(i.a)({url:"/api/ass/assOrgTemplateItem/del",method:"post",params:{ids:e}})}(this.selectionitems.id).then(function(t){e.getasslist(),e.$message({message:t.msg,type:"success"})}).catch(function(t){e.getasslist()})},handleFilter:function(){var e={officeid:this.value2,year:this.condition.year,month:this.condition.month};console.log("condition",e)},submitBtn:function(){var e=this,t={id:this.proTaskFrom.id,name:this.proTaskFrom.name,content:this.proTaskFrom.content,score:this.proTaskFrom.score,standard:this.proTaskFrom.standard};null!=t.name&&null!=t.content&&null!=t.score&&null!=t.standard?function(e){return Object(i.a)({url:"/api/ass/assOrgTemplateItem/save",method:"post",data:e})}(t).then(function(t){1==response.success&&e.$message({message:response.msg,type:"success"}),e.addVisible=!1,e.editVisible=!1,e.getasslist()}).catch(function(t){e.addVisible=!1,e.editVisible=!1,e.getasslist()}):this.$message({message:"输入不能为空",type:"error"})},handleCurrentChange:function(e){e&&(this.selectionitems=e,this.proTaskFrom.id=e.id)},inputChange:function(e,t,a){this.scorelist[e].fraction=t;var s={item_id:a.id,score:t};if(this.idvalue.length>0){var l=!1;for(var i in this.idvalue)this.idvalue[i].item_id==a.id&&this.idvalue[i].score!==t&&(this.idvalue[i].score=t,l=!0);l||(this.idvalue.push(s),l=!1)}else this.idvalue.push(s)},scoreBtn:function(){var e=this,t={office:this.value3,year:this.condition.year,month:this.condition.month,idvalues:l()(this.idvalue)};null!=t.office&&""!=t.office?function(e){return Object(i.a)({url:"/api/ass/assOrgScores/save",method:"post",data:e})}(t).then(function(t){e.scoreVisible=!1,e.$message({message:"评分成功",type:"success"})}):this.$message({message:"请选择单位",type:"warning"})},getCount:function(e){var t=e.columns,a=e.data,s=[],l=[];return t.forEach(function(e,t){0!==t?("score"==e.property&&(l=a.map(function(e){return Number(e.score)})),"score"==e.property?(s[t]=l.reduce(function(e,t){var a=Number(t);return isNaN(a)?e:e+t},0),s[t]+="分"):s[t]=""):s[t]="合计"}),this.totalscore=s,s}}},u=a("KHd+"),m=Object(u.a)(c,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.v.loading,expression:"v.loading"}]},[a("el-container",[a("el-header",{attrs:{height:"125px"}},[a("div",{staticClass:"topTitle"},[e._v("考核评分表")]),e._v(" "),a("div",{staticClass:"filter-container"},[[a("div",{staticClass:"block"},[e._v("单位名称\n              "),a("el-select",{attrs:{clearable:!0,placeholder:"请选择"},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})})),e._v("日期选择\n              "),a("el-date-picker",{attrs:{type:"year",format:"yyyy年","value-format":"yyyy",placeholder:"选择年",clearable:!1},on:{change:e.yearselection},model:{value:e.yearvalue,callback:function(t){e.yearvalue=t},expression:"yearvalue"}}),e._v(" "),a("el-date-picker",{attrs:{type:"month",format:"M月","value-format":"M",placeholder:"选择月",clearable:!1},on:{change:e.monthselection},model:{value:e.monthvalue,callback:function(t){e.monthvalue=t},expression:"monthvalue"}}),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleFilter},slot:"reference"},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"primary",icon:"el-icon-setting",size:"mini"},on:{click:e.getasslist},slot:"reference"},[e._v("考核设置")])],1)]],2)]),e._v(" "),a("el-main",[a("div",{staticClass:"filter-container",staticStyle:{"padding-top":"0"}},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-tickets"},on:{click:e.assscore}},[e._v("考核评分")]),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"info",icon:"el-icon-delete"}},[e._v("删除")])],1),e._v(" "),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{"row-key":"id",stripe:"",border:""},on:{"selection-change":e.assessmentchange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",width:"50",border:"",align:"center",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"单位名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"日常巡查"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"公众投诉"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"宣传教育工作"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"奖励分"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"时间处理率"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"水质变化"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"领导综合评估"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"其他"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"总分"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作  ",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(a){e.edit(t.row)}}})]}}])})],1)],1),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("提交")])],1),e._v(" "),a("el-dialog",{attrs:{visible:e.settingVisible,title:"修改考核模板","modal-append-to-body":!1,width:"60%"},on:{"update:visible":function(t){e.settingVisible=t}}},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:e.editassBtn}},[e._v("编辑考核项")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-delete"},on:{click:e.delassBtn}},[e._v("删除考核项")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline"},on:{click:e.addassBtn}},[e._v("新增考核项")]),e._v(" "),a("div",[[a("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.list,"highlight-current-row":"",border:!0,"summary-method":e.getCount,"show-summary":""},on:{"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{prop:"name",label:"考核项目",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"content",label:"考评内容",width:"400"}}),e._v(" "),a("el-table-column",{attrs:{prop:"score",label:"基本分",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"standard",label:"考核标准",width:"400"}})],1),e._v(" "),a("div")]],2)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.scoreVisible,title:"考核评分","modal-append-to-body":!1,width:"66%"},on:{"update:visible":function(t){e.scoreVisible=t}}},[[a("div",[a("span",[e._v("日期选择")]),e._v(" "),a("el-date-picker",{attrs:{type:"year",format:"yyyy年","value-format":"yyyy",placeholder:"选择年",clearable:!1},on:{change:e.yearselection2},model:{value:e.yearvalue2,callback:function(t){e.yearvalue2=t},expression:"yearvalue2"}}),e._v(" "),a("el-date-picker",{attrs:{type:"month",format:"M月","value-format":"M",placeholder:"选择月",clearable:!1},on:{change:e.monthselection2},model:{value:e.monthvalue2,callback:function(t){e.monthvalue2=t},expression:"monthvalue2"}}),e._v(" "),a("span",[e._v("单位选择")]),e._v(" "),a("el-select",{attrs:{clearable:!0,placeholder:"请选择"},model:{value:e.value3,callback:function(t){e.value3=t},expression:"value3"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})}))],1),e._v(" "),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.scoreloading,expression:"scoreloading"}],staticStyle:{width:"100%"},attrs:{data:e.scorelist,"highlight-current-row":"",border:!0,"summary-method":e.getCount,"show-summary":""},on:{"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{prop:"name",label:"考核项目",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"content",label:"考评内容",width:"400"}}),e._v(" "),a("el-table-column",{attrs:{prop:"score",label:"基本分",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"standard",label:"考核标准",width:"400"}}),e._v(" "),a("el-table-column",{attrs:{prop:"fraction",label:"得分",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticStyle:{width:"80px"},attrs:{size:"small",id:"index",type:"number",placeholder:"请打分"},on:{change:function(a){e.inputChange(t.$index,t.numberscore,t.row)}},model:{value:t.numberscore,callback:function(a){e.$set(t,"numberscore",a)},expression:"scope.numberscore"}}),e._v(" "),a("span",[e._v("分")])]}}])})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.scoreBtn}},[e._v("提交")])],1)],1)]],2),e._v(" "),a("el-dialog",{attrs:{title:"新增考核项",visible:e.addVisible},on:{"update:visible":function(t){e.addVisible=t}}},[a("el-form",[a("el-form-item",{attrs:{label:"考核项目"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入考核项目",rows:"1"},model:{value:e.proTaskFrom.name,callback:function(t){e.$set(e.proTaskFrom,"name",t)},expression:"proTaskFrom.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"考评内容"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入考评内容",rows:"3"},model:{value:e.proTaskFrom.content,callback:function(t){e.$set(e.proTaskFrom,"content",t)},expression:"proTaskFrom.content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"基本分"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入基本分",rows:"1"},model:{value:e.proTaskFrom.score,callback:function(t){e.$set(e.proTaskFrom,"score",t)},expression:"proTaskFrom.score"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"考核标准"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入考核标准",rows:"3"},model:{value:e.proTaskFrom.standard,callback:function(t){e.$set(e.proTaskFrom,"standard",t)},expression:"proTaskFrom.standard"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("新增提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑考核项",visible:e.editVisible},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",[a("el-form-item",{attrs:{label:"考核项目"}},[a("el-input",{attrs:{type:"textscore",rows:"1"},model:{value:e.proTaskFrom.name,callback:function(t){e.$set(e.proTaskFrom,"name",t)},expression:"proTaskFrom.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"考评内容"}},[a("el-input",{attrs:{type:"textscore",rows:"3"},model:{value:e.proTaskFrom.content,callback:function(t){e.$set(e.proTaskFrom,"content",t)},expression:"proTaskFrom.content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"基本分"}},[a("el-input",{attrs:{type:"textscore",rows:"1"},model:{value:e.proTaskFrom.score,callback:function(t){e.$set(e.proTaskFrom,"score",t)},expression:"proTaskFrom.score"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"考核标准"}},[a("el-input",{attrs:{type:"textscore",rows:"3"},model:{value:e.proTaskFrom.standard,callback:function(t){e.$set(e.proTaskFrom,"standard",t)},expression:"proTaskFrom.standard"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("修改提交")])],1)],1)],1)],1)],1)},[],!1,null,null,null);m.options.__file="assessment.vue";t.default=m.exports},"gDS+":function(e,t,a){e.exports={default:a("oh+g"),__esModule:!0}},"oh+g":function(e,t,a){var s=a("WEpk"),l=s.JSON||(s.JSON={stringify:JSON.stringify});e.exports=function(e){return l.stringify.apply(l,arguments)}}}]);