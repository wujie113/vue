(window.webpackJsonp=window.webpackJsonp||[]).push([["psQm"],{psQm:function(e,t,a){"use strict";a.r(t);var l=a("t3Un");function o(e){return Object(l.a)({url:"/api/ass/assOrgTemplateItem/list",method:"get",params:e})}var s={components:{},data:function(){return{v:{loading:!1},list:null,addVisible:!1,editVisible:!1,settingVisible:!1,popoverVisible:!1,value2:null,yearvalue:"",monthvalue:"",scoreVisible:!1,query:{total:0,pageNo:1,pageSize:10,search:void 0,type:"5"},numberscore:null,proTaskFrom:{id:null,name:null,content:null,score:null,standard:null},condition:{year:null,month:null},selectionitems:null,options:[]}},created:function(){this.getarealist()},methods:{getarealist:function(){var e=this;Object(l.a)({url:"/api/ass/assOrgTemplateItem/getarealist",method:"get"}).then(function(t){e.options=t.data.list,console.log("this.options",e.options)})},edit:function(e){alert("修改windows")},yearselection:function(e){var t=this;this.condition.year=e;var a=(new Date).getMonth()+1+"月";console.log("month",a),this.monthvalue=a,o({year:this.condition.year}).then(function(e){t.list=e.data.list,t.$message({message:"查询成功",type:"success"})})},monthselection:function(e){var t=this;this.condition.month=e,console.log("this.condition",this.condition),o(this.condition).then(function(e){t.list=e.data.list,t.$message({message:"查询成功",type:"success"})})},assessmentchange:function(e){this.multipleSelection=e},assitemchange:function(e){this.multipleSelection=e},assscore:function(){this.scoreVisible=!0,this.getasslist(),this.settingVisible=!1},getasslist:function(){var e=this;this.settingVisible=!0,o().then(function(t){e.list=t.data.list})},addassBtn:function(){this.addVisible=!0,this.proTaskFrom=[]},editassBtn:function(){null==this.selectionitems?this.$message({message:"请选择编辑项",type:"error"}):(this.editVisible=!0,this.proTaskFrom=this.selectionitems)},delassBtn:function(){var e=this;null==this.selectionitems?this.$message({message:"请选择删除项",type:"error"}):function(e){return Object(l.a)({url:"/api/ass/assOrgTemplateItem/del",method:"post",params:{ids:e}})}(this.selectionitems.id).then(function(t){e.getasslist(),e.$message({message:t.msg,type:"success"})})},handleFilter:function(){var e={officeid:this.value2,year:this.condition.year,month:this.condition.month};console.log("condition",e)},submitBtn:function(){var e=this,t={id:this.proTaskFrom.id,name:this.proTaskFrom.name,content:this.proTaskFrom.content,score:this.proTaskFrom.score,standard:this.proTaskFrom.standard};console.log("proTaskFrom",t),null!=t.name&&null!=t.content&&null!=t.score&&null!=t.standard?function(e){return Object(l.a)({url:"/api/ass/assOrgTemplateItem/save",method:"post",data:e})}(t).then(function(t){e.addVisible=!1,e.editVisible=!1,e.getasslist(),e.$message({message:"处理成功",type:"success"})}):this.$message({message:"输入不能为空",type:"error"})},handleCurrentChange:function(e){this.selectionitems=e,this.proTaskFrom.id=e.id},getCount:function(e){var t=e.columns,a=e.data,l=[],o=[];return t.forEach(function(e,t){0!==t?(o="score"===e.property?a.map(function(e){return Number(e.score)}):a.map(function(e){return Number(e.other)}),"score"===e.property||"other"===e.property?(l[t]=o.reduce(function(e,t){var a=Number(t);return isNaN(a)?e:e+t},0),l[t]):l[t]=""):l[t]="合计"}),console.log(l),l}}},n=a("KHd+"),i=Object(n.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.v.loading,expression:"v.loading"}]},[a("el-container",[a("el-header",{attrs:{height:"125px"}},[a("div",{staticClass:"topTitle"},[e._v("考核评分表")]),e._v(" "),a("div",{staticClass:"filter-container"},[[a("div",{staticClass:"block"},[e._v("\n            单位名称\n              "),a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v("\n              日期选择\n               "),a("el-date-picker",{attrs:{type:"year",format:"yyyy年","value-format":"yyyy",placeholder:"选择年"},on:{change:e.yearselection},model:{value:e.yearvalue,callback:function(t){e.yearvalue=t},expression:"yearvalue"}}),e._v(" "),a("el-date-picker",{attrs:{type:"month",format:"M月","value-format":"M",placeholder:"选择月"},on:{change:e.monthselection},model:{value:e.monthvalue,callback:function(t){e.monthvalue=t},expression:"monthvalue"}}),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleFilter},slot:"reference"},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"primary",icon:"el-icon-setting",size:"mini"},on:{click:e.getasslist},slot:"reference"},[e._v("考核设置")])],1)]],2)]),e._v(" "),a("el-main",[a("div",{staticClass:"filter-container",staticStyle:{"padding-top":"0"}},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-tickets"},on:{click:e.assscore}},[e._v("考核评分")]),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"info",icon:"el-icon-delete"}},[e._v("删除")])],1),e._v(" "),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{"row-key":"id",stripe:"",border:""},on:{"selection-change":e.assessmentchange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",width:"50",border:"",align:"center",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"单位名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"日常巡查"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"公众投诉"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"宣传教育工作"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"奖励分"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"时间处理率"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"水质变化"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"领导综合评估"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"其他"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"总分"}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作  ",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(a){e.edit(t.row)}}})]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.query.total>0,expression:"query.total>0"}],attrs:{total:e.query.total,page:e.query.pageNo,limit:e.query.pageSize},on:{"update:page":function(t){e.$set(e.query,"pageNo",t)},"update:limit":function(t){e.$set(e.query,"pageSize",t)}}})],1),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("提交")])],1),e._v(" "),a("el-dialog",{attrs:{visible:e.settingVisible,title:"修改考核模板","modal-append-to-body":!1,width:"60%"},on:{"update:visible":function(t){e.settingVisible=t}}},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:e.editassBtn}},[e._v("编辑考核项")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-delete"},on:{click:e.delassBtn}},[e._v("删除考核项")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline"},on:{click:e.addassBtn}},[e._v("新增考核项")]),e._v(" "),a("div",[[a("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.list,"highlight-current-row":"",border:!0,"summary-method":e.getCount,"show-summary":""},on:{"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{prop:"name",label:"考核项目",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"content",label:"考评内容",width:"400"}}),e._v(" "),a("el-table-column",{attrs:{prop:"score",label:"基本分",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"standard",label:"考核标准",width:"400"}})],1),e._v(" "),a("div")]],2)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.scoreVisible,title:"考核评分","modal-append-to-body":!1,width:"65%"},on:{"update:visible":function(t){e.scoreVisible=t}}},[[a("div",{staticClass:"block"},[a("span",[e._v("日期选择")]),e._v(" "),a("el-date-picker",{attrs:{type:"year",format:"yyyy年","value-format":"yyyy",placeholder:"选择年"},on:{change:e.yearselection},model:{value:e.yearvalue,callback:function(t){e.yearvalue=t},expression:"yearvalue"}}),e._v(" "),a("el-date-picker",{attrs:{type:"month",format:"M月","value-format":"M",placeholder:"选择月"},on:{change:e.monthselection},model:{value:e.monthvalue,callback:function(t){e.monthvalue=t},expression:"monthvalue"}}),e._v(" "),a("span",[e._v("单位选择")]),e._v(" "),a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("div",[a("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.list,"highlight-current-row":"",border:!0,"summary-method":e.getCount,"show-summary":""},on:{"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{prop:"name",label:"考核项目",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"content",label:"考评内容",width:"400"}}),e._v(" "),a("el-table-column",{attrs:{prop:"score",label:"基本分",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"standard",label:"考核标准",width:"400"}}),e._v(" "),a("el-table-column",{attrs:{label:"得分",prop:"fraction",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticStyle:{width:"80px"},attrs:{size:"small",placeholder:"请打分"},model:{value:t.numberscore,callback:function(a){e.$set(t,"numberscore",a)},expression:"scope.numberscore"}}),e._v(" "),a("span",[e._v("分")])]}}])})],1),e._v(" "),a("div"),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{type:"primary"}},[e._v("提交")])],1)],1)]],2),e._v(" "),a("el-dialog",{attrs:{title:"新增考核项",visible:e.addVisible},on:{"update:visible":function(t){e.addVisible=t}}},[a("el-form",[a("el-form-item",{attrs:{label:"考核项目"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入考核项目",rows:"1"},model:{value:e.proTaskFrom.name,callback:function(t){e.$set(e.proTaskFrom,"name",t)},expression:"proTaskFrom.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"考评内容"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入考评内容",rows:"3"},model:{value:e.proTaskFrom.content,callback:function(t){e.$set(e.proTaskFrom,"content",t)},expression:"proTaskFrom.content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"基本分"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入基本分",rows:"1"},model:{value:e.proTaskFrom.score,callback:function(t){e.$set(e.proTaskFrom,"score",t)},expression:"proTaskFrom.score"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"考核标准"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入考核标准",rows:"3"},model:{value:e.proTaskFrom.standard,callback:function(t){e.$set(e.proTaskFrom,"standard",t)},expression:"proTaskFrom.standard"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑考核项",visible:e.editVisible},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",[a("el-form-item",{attrs:{label:"考核项目"}},[a("el-input",{attrs:{type:"textarea",rows:"1"},model:{value:e.proTaskFrom.name,callback:function(t){e.$set(e.proTaskFrom,"name",t)},expression:"proTaskFrom.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"考评内容"}},[a("el-input",{attrs:{type:"textarea",rows:"3"},model:{value:e.proTaskFrom.content,callback:function(t){e.$set(e.proTaskFrom,"content",t)},expression:"proTaskFrom.content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"基本分"}},[a("el-input",{attrs:{type:"textarea",rows:"1"},model:{value:e.proTaskFrom.score,callback:function(t){e.$set(e.proTaskFrom,"score",t)},expression:"proTaskFrom.score"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"考核标准"}},[a("el-input",{attrs:{type:"textarea",rows:"3"},model:{value:e.proTaskFrom.standard,callback:function(t){e.$set(e.proTaskFrom,"standard",t)},expression:"proTaskFrom.standard"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("提交")])],1)],1)],1)],1)],1)},[],!1,null,null,null);i.options.__file="assessment.vue";t.default=i.exports}}]);