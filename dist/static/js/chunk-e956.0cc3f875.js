(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-e956"],{"/V5w":function(t,a,e){"use strict";e.d(a,"a",function(){return l}),e.d(a,"b",function(){return i});var n=e("t3Un");function l(t){return Object(n.a)({url:"/api/dc/asschart",method:"get",params:t})}function i(t){return Object(n.a)({url:"/api/dc/complaintchart",method:"get",params:t})}},"86T4":function(t,a,e){"use strict";e.r(a);var n=e("MT78"),l=e.n(n),i=e("/V5w"),o={name:"complaintstatistics",data:function(){return{filename:"",autoWidth:!0,bookType:"xlsx",downloadLoading:!1,loading:!1,tableData:[],legendDataArray:[],echartsData:{},clientHeight:"",year:"",yearMonth:"",value1:"",value2:"",activeName:"first"}},created:function(){this.getChartsList(),this.year=(new Date).getFullYear(),this.filename=this.year+"年全部投诉统计报表"},mounted:function(){var t=this.getHeight(document.getElementsByClassName("app-container")[0])-217;console.log("--mounted周期",t),this.clientHeight=t;var a=this;window.onresize=function(){a.clientHeight=a.getHeight(document.getElementsByClassName("app-container")[0])-217,console.log("window.onresize",a.clientHeight)},this.init()},methods:{init:function(){var t=this;setTimeout(function(){window.onresize=function(){t.$refs.myChart&&(t.chart=l.a.init(t.$refs.myChart),t.chart.resize())}},20)},getChartsList:function(){var t=this,a={year:this.year};this.tableData=[],this.loading=!0,Object(i.b)(a).then(function(a){t.echartsData=a.data,t.legendDataArray=a.data.series.map(function(t){return t.name});var e=["#ff7370","#48dff0","#52b4ff","#ff66a3","#5ce5aa","#c484f5","#ffb870","#fae164"],n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.echartsData.series.map(function(a,l){for(var i={type:a.name},o=0;o<n.length;o++)i[n[o]]=a.data[o];t.tableData.push(i),a.type="bar",a.tooltip={trigger:"item"},a.stack="group1",a.barCategoryGap="55%",a.itemStyle={normal:{color:e[l%e.length]}}}),t.drawBar(),t.loading=fase}).catch(function(a){t.loading=!1})},handleClick:function(t,a){var e=this;"first"==t.paneName&&setTimeout(function(){e.drawBar()},100)},tabYearChange:function(t){this.year=new Date(t).getFullYear(),this.filename=this.year+"年全部投诉统计报表",this.getChartsList()},handleDownload:function(){var t=this;this.downloadLoading=!0,Promise.all([e.e("chunk-7a57"),e.e("chunk-3c5e"),e.e("chunk-48a8")]).then(e.bind(null,"S/jZ")).then(function(a){var e=["type","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=t.tableData,l=t.formatJson(e,n);console.log("this.formatJson(filterVal, list)",t.formatJson(e,n)),a.export_json_to_excel({header:["类型","一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],data:l,filename:t.filename,autoWidth:t.autoWidth,bookType:t.bookType}),t.downloadLoading=!1})},formatJson:function(t,a){return a.map(function(a){return t.map(function(t){return"timestamp"===t?parseTime(a[t]):a[t]})})},drawBar:function(){this.chart1=l.a.init(this.$refs.myChart),this.chart1.setOption({title:{text:this.echartsData.title,x:"center",y:"3%",textStyle:{color:"#008acd",fontSize:16}},tooltip:{show:!0,trigger:"axis"},legend:{data:this.legendDataArray,x:"7%",y:"10%"},color:["#52b4ff","#fa7de5","#48dff0","#ff7370","#5ce5aa","#ffb870","#bc84f5","#fae164","#778eff","#ff7faa"],dataZoom:{show:!1,realtime:!0,height:20,end:100,handleSize:"20px"},grid:{x:"5%",x2:"5%",y:"20%",y2:"14%"},xAxis:[{name:"河段",type:"category",data:this.echartsData.xAxisData,axisLabel:{interval:0,rotate:60,textStyle:{color:"#000"}},axisLine:{lineStyle:{color:"#008acd"}}}],yAxis:[{type:"value",name:"次数",axisLine:{lineStyle:{color:"#008acd"}}}],series:this.echartsData.series})},tabMonthChange:function(t){console.log("tabMonth",t)}}},r=(e("v7Je"),e("KHd+")),s=Object(r.a)(o,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"app-container"},[e("el-container",[e("el-container",[e("el-header",{attrs:{height:"125px"}},[e("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"投诉统计图",name:"first"}},[e("div",{staticClass:"filter-container"},[e("div",{staticClass:"block"},[e("span",{staticClass:"demonstration"},[t._v("年份")]),t._v(" "),e("el-date-picker",{attrs:{type:"year",placeholder:"选择年"},on:{change:t.tabYearChange},model:{value:t.value1,callback:function(a){t.value1=a},expression:"value1"}})],1)])]),t._v(" "),e("el-tab-pane",{attrs:{label:"投诉统计报表",name:"second"}},[e("div",{staticClass:"filter-container"},[e("div",{staticClass:"block"},[e("span",{staticClass:"demonstration"},[t._v("年份")]),t._v(" "),e("el-date-picker",{attrs:{type:"year",placeholder:"选择年"},on:{change:t.tabYearChange},model:{value:t.value1,callback:function(a){t.value1=a},expression:"value1"}}),t._v(" "),e("el-button",{staticStyle:{margin:"0 0 20px 20px"},attrs:{loading:t.downloadLoading,type:"primary",icon:"document"},on:{click:t.handleDownload}},[t._v("下载Excel")])],1)])])],1)],1),t._v(" "),e("el-main",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},["first"===t.activeName?e("div",{staticClass:"canvasBox"},[e("div",{ref:"myChart",style:{width:"100%",height:t.clientHeight+"px"},attrs:{id:"myChart"}})]):t._e(),t._v(" "),"second"===t.activeName?e("div",{staticClass:"canvasBox"},[e("h6",{staticStyle:{"font-size":"20px",margin:"0px 0 20px 0","text-align":"center","font-weight":"normal"}},[t._v(t._s(t.year)+"年全部投诉统计报表")]),t._v(" "),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"","header-cell-style":{color:"#333333"}}},[e("el-table-column",{attrs:{prop:"type",label:"类型"}}),t._v(" "),e("el-table-column",{attrs:{prop:"Jan",label:"一月"}}),t._v(" "),e("el-table-column",{attrs:{prop:"Feb",label:"二月"}}),t._v(" "),e("el-table-column",{attrs:{prop:"Mar",label:"三月"}}),t._v(" "),e("el-table-column",{attrs:{prop:"Apr",label:"四月"}}),t._v(" "),e("el-table-column",{attrs:{prop:"May",label:"五月"}}),t._v(" "),e("el-table-column",{attrs:{prop:"Jun",label:"六月"}}),t._v(" "),e("el-table-column",{attrs:{prop:"Jul",label:"七月"}}),t._v(" "),e("el-table-column",{attrs:{prop:"Aug",label:"八月"}}),t._v(" "),e("el-table-column",{attrs:{prop:"Sep",label:"九月"}}),t._v(" "),e("el-table-column",{attrs:{prop:"Oct",label:"十月"}}),t._v(" "),e("el-table-column",{attrs:{prop:"Nov",label:"十一月"}}),t._v(" "),e("el-table-column",{attrs:{prop:"Dec",label:"十二月"}})],1)],1):t._e()])],1)],1)],1)},[],!1,null,"0794e30f",null);s.options.__file="complaintstatistics.vue";a.default=s.exports},m06K:function(t,a,e){},v7Je:function(t,a,e){"use strict";var n=e("m06K");e.n(n).a}}]);