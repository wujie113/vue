(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-commons"],{"0y1S":function(e,t,i){"use strict";var n=i("iG3g");i.n(n).a},"2iLR":function(e,t,i){"use strict";var n=i("h6z/");i.n(n).a},"4A2f":function(e,t,i){"use strict";var n=i("Cppj"),a={name:"RmDict",props:{value:{required:!1},placeholder:{required:!1,type:String,default:"--请选择--"},title:{required:!1,type:String,default:"--"},type:{required:!0,type:String}},data:function(){return{optionlists:[]}},computed:{},created:function(){this.getDictList()},methods:{getDictList:function(){var e=this;Object(n.a)(this.type).then(function(t){e.optionlists=t.data.list,console.log(" this.optionlists ",e.optionlists)})},handleInput:function(e){this.$emit("input",e)}}},o=(i("0y1S"),i("KHd+")),r=Object(o.a)(a,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-select",{attrs:{clearable:"",title:e.title,placeholder:e.placeholder,value:e.value},on:{input:e.handleInput}},e._l(e.optionlists,function(t){return i("el-option",e._b({key:t.value,attrs:{label:t.label,value:t.value}},"el-option",e.$attrs,!1))}))},[],!1,null,"4b94a6cb",null);r.options.__file="index.vue";t.a=r.exports},"AL3+":function(e,t,i){},Cppj:function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i("t3Un");function a(e){return Object(n.a)({url:"/api/sys/dict/find",method:"get",params:{type:e}})}},Grqa:function(e,t,i){"use strict";var n={name:"MdInput",props:{icon:String,name:String,type:{type:String,default:"text"},value:[String,Number],placeholder:String,readonly:Boolean,disabled:Boolean,min:String,max:String,step:String,minlength:Number,maxlength:Number,required:{type:Boolean,default:!0},autoComplete:{type:String,default:"off"},validateEvent:{type:Boolean,default:!0}},data:function(){return{currentValue:this.value,focus:!1,fillPlaceHolder:null}},computed:{computedClasses:function(){return{"material--active":this.focus,"material--disabled":this.disabled,"material--raised":Boolean(this.focus||this.currentValue)}}},watch:{value:function(e){this.currentValue=e}},methods:{handleModelInput:function(e){var t=e.target.value;this.$emit("input",t),"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.change",[t]),this.$emit("change",t)},handleMdFocus:function(e){this.focus=!0,this.$emit("focus",e),this.placeholder&&""!==this.placeholder&&(this.fillPlaceHolder=this.placeholder)},handleMdBlur:function(e){this.focus=!1,this.$emit("blur",e),this.fillPlaceHolder=null,"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.blur",[this.currentValue])}}},a=(i("UJM3"),i("KHd+")),o=Object(a.a)(n,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"material-input__component",class:e.computedClasses},[i("div",{class:{iconClass:e.icon}},[e.icon?i("i",{staticClass:"el-input__icon material-input__icon",class:["el-icon-"+e.icon]}):e._e(),e._v(" "),"email"===e.type?i("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autoComplete:e.autoComplete,required:e.required,type:"email"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"url"===e.type?i("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autoComplete:e.autoComplete,required:e.required,type:"url"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"number"===e.type?i("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,step:e.step,readonly:e.readonly,disabled:e.disabled,autoComplete:e.autoComplete,max:e.max,min:e.min,minlength:e.minlength,maxlength:e.maxlength,required:e.required,type:"number"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"password"===e.type?i("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autoComplete:e.autoComplete,max:e.max,min:e.min,required:e.required,type:"password"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"tel"===e.type?i("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autoComplete:e.autoComplete,required:e.required,type:"tel"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"text"===e.type?i("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autoComplete:e.autoComplete,minlength:e.minlength,maxlength:e.maxlength,required:e.required,type:"text"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),i("span",{staticClass:"material-input-bar"}),e._v(" "),i("label",{staticClass:"material-label"},[e._t("default")],2)])])},[],!1,null,"98a68c64",null);o.options.__file="index.vue";t.a=o.exports},JThA:function(e,t,i){"use strict";var n=i("LeN3");i.n(n).a},LeN3:function(e,t,i){},Mz3J:function(e,t,i){"use strict";var n=i("Y5bG"),a={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&Object(n.a)(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&Object(n.a)(0,800)}}},o=(i("thBn"),i("KHd+")),r=Object(o.a)(a,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[i("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},[],!1,null,"433c5283",null);r.options.__file="index.vue";t.a=r.exports},NhUi:function(e,t,i){"use strict";var n=i("gDS+"),a=i.n(n),o=(i("W8A/"),i("Xu5n")),r=i("oscj"),s=i("Pmt0"),l=i("t3Un"),c=i("jzpJ"),u=i("nUcq"),d=i("Ag9w"),h=i("pWiS"),m=i("9ANI"),p=i("BxA5"),f=i("Nafy"),g=i("nHi6"),y=i("SAzV"),v=i("LvFn"),w=i("W8M7"),b=i("mkQN"),k=i("bHcU"),x=i("hoJM"),z=i("g6Z0"),_=i("gpXz"),S=i("zixo"),I=i("bL/2"),C=function(e,t){var i=new k.c({stroke:new x.a({color:"blue",width:2}),fill:new z.a({color:"rgba(0,0,255,0.2)"})});return t<=429e-7&&i.setText(new _.a({text:e.get("name"),fill:new z.a({color:"blue"}),stroke:new x.a({color:"#fff",width:1})})),[i,new k.c({image:new S.a({radius:1.5,fill:new z.a({color:"#00f"}),stroke:new x.a({color:"#fff",width:1})}),geometry:function(e){var t=e.getGeometry().getCoordinates();return e.getGeometry()instanceof w.a&&(t=t[0]),new b.a(t)}})]},L=function(e,t){return new k.c({stroke:new x.a({color:"#FF6100",width:2.5}),fill:new z.a({color:"rgba(255,0,0,0.8)"}),text:new _.a({text:e.get("name"),fill:new z.a({color:"#000000"}),stroke:new x.a({color:"#ffffff",width:1})})})},T=function(e,t){return[new k.c({fill:new z.a({color:"rgba(255, 0, 0, 0.2)"}),stroke:new x.a({color:"#ff0000",width:2}),image:new S.a({radius:7,fill:new z.a({color:"#ffffff"})}),text:new _.a({text:e.get("name"),fill:new z.a({color:"#000000"}),stroke:new x.a({color:"#ffffff",width:1})})}),new k.c({image:new S.a({radius:2.5,fill:new z.a({color:"#f00"}),stroke:new x.a({color:"#ffffff",width:1})}),geometry:function(e){var t=e.getGeometry().getCoordinates();return e.getGeometry()instanceof w.a&&(t=t[0]),new b.a(t)}})]},O=function(e,t){return new k.c({stroke:new x.a({color:"gray",width:2}),fill:new z.a({color:"rgba(255,0,0,0.2)"})})},E=function(e,t){var i=e.get("gtype");return"tousu"===i?j(e,t):"shangbao"===i?M(e,t):"trail"===i?A(e,t):[new k.c({fill:new z.a({color:"rgba(255, 0, 0, 0.2)"}),stroke:new x.a({color:"#ff0000",width:2.5}),image:new S.a({radius:3,fill:new z.a({color:"#ff0000"})}),text:new _.a({text:e.get("name"),fill:new z.a({color:"#000000"}),stroke:new x.a({color:"#ffffff",width:1})})}),new k.c({image:new S.a({radius:3,fill:new z.a({color:"#ff0000"})}),geometry:function(e){var t=e.getGeometry().getCoordinates();return e.getGeometry()instanceof w.a&&(t=t[0]),new b.a(t)}})]},j=function(e,t){return new k.c({stroke:new x.a({color:"#ff0000",width:4}),image:new I.a({anchor:[.5,48],anchorXUnits:"fraction",anchorYUnits:"pixels",size:[48,48],src:i("iE6R")}),text:new _.a({text:e.get("name"),fill:new z.a({color:"#000000"}),stroke:new x.a({color:"#ffffff",width:1})})})},M=function(e,t){return new k.c({stroke:new x.a({color:"#ff0000",width:4}),image:new I.a({anchor:[.5,48],anchorXUnits:"fraction",anchorYUnits:"pixels",size:[48,48],src:i("M5w+")}),text:new _.a({text:e.get("name"),fill:new z.a({color:"#000000"}),stroke:new x.a({color:"#ffffff",width:1})})})},F=new k.c({image:new S.a({radius:12,fill:new z.a({color:"#fff"}),stroke:new x.a({color:"#409EFF",width:3})}),text:new _.a({text:"Go",fill:new z.a({color:"#000000"})})}),A=function(e,t){var n=e.get("type");return{trailMarker1:null,trailStart:new k.c({image:new I.a({anchor:[.5,48],anchorXUnits:"fraction",anchorYUnits:"pixels",size:[48,48],src:i("jHyR")}),text:new _.a({text:e.get("name"),fill:new z.a({color:"#000000"})})}),trailEnd:new k.c({image:new I.a({anchor:[.5,48],anchorXUnits:"fraction",anchorYUnits:"pixels",size:[48,48],src:i("mZ2b")}),text:new _.a({text:e.get("name"),fill:new z.a({color:"#000000"})})}),trail:[new k.c({stroke:new x.a({color:"#409EFF",width:4,lineCap:"square",lineDash:[5,9]}),text:new _.a({font:"14px Microsoft YaHei",text:e.get("name"),fill:new z.a({color:"#409EFF"}),stroke:new x.a({color:"#ffffff",width:1})})}),new k.c({image:new S.a({radius:4,fill:new z.a({color:"#fff"}),stroke:new x.a({color:"#409EFF",width:2})}),geometry:function(e){var t=e.getGeometry().getCoordinates();return e.getGeometry()instanceof w.a&&(t=t[0]),new b.a(t)}})]}[n]},V=function(e,t){return new k.c({stroke:new x.a({color:"green",width:2}),fill:new z.a({color:"rgba(255,0,0,0.2)"}),image:new I.a({anchor:[.5,32],anchorXUnits:"fraction",anchorYUnits:"pixels",size:[32,32],src:i("WL5l")}),text:new _.a({text:e.get("name"),offsetY:12,fill:new z.a({color:"#000"}),stroke:new x.a({color:"#fff",width:1})})})},B=function(e,t){return[V(e),new k.c({image:new S.a({radius:5,stroke:new x.a({color:"rgba(0, 0, 0, 0.7)"}),fill:new z.a({color:"rgba(255, 255, 255, 0.2)"})}),geometry:function(e){var t=e.getGeometry().getCoordinates();return e.getGeometry()instanceof w.a&&(t=t[0]),new b.a(t)}})]},N=function(e,t){return[new k.c({fill:new z.a({color:"rgba(255, 255, 255, 0.2)"}),stroke:new x.a({color:"#E6A23C",lineDash:[10,10],width:3.5}),image:new S.a({radius:5,stroke:new x.a({color:"rgba(0, 0, 0, 0.7)"}),fill:new z.a({color:"rgba(255, 255, 255, 0.2)"})})}),new k.c({image:new S.a({radius:5,stroke:new x.a({color:"#E6A23C"}),fill:new z.a({color:"rgba(255, 255, 255, 0.5)"})}),geometry:function(e){var t=e.getGeometry().getCoordinates();return e.getGeometry()instanceof w.a&&(t=t[0]),new b.a(t)}})]},P={wmsServerUrl2:"http://117.40.230.32:10103/geoserver/zhhz/wms",wmsServerUrl:"http://117.26.177.186:8090/geoserver/zhhz/wms",wfsServerUrl:"http://117.26.177.186:8090/geoserver/zhhz/ows",wmtsServerUrl:"http://117.40.230.32:10103/geoserver/gwc/service/wmts",projection:"EPSG:4326",center:[119.532727,26.666832],minZoom:6,zoom:14,bglayers:[{id:"googleS",name:"google卫星",layer:new g.a({layers:[new y.a({zIndex:0,source:new v.a({title:"Google影像图",url:"http://www.google.cn/maps/vt?lyrs=s@189&gl=cn&x={x}&y={y}&z={z}"})}),new y.a({zIndex:1,source:new v.a({title:"Google影像注记",url:"http://www.google.cn/maps/vt?lyrs=h@189&gl=cn&x={x}&y={y}&z={z}"})})]}),visible:!0},{id:"google",name:"google电子",layer:new g.a({layers:[new y.a({zIndex:0,source:new v.a({title:"Google电子地图",url:"http://www.google.cn/maps/vt?lyrs=m@189&gl=cn&x={x}&y={y}&z={z}"})}),new y.a({zIndex:1,source:new v.a({title:"Google交通地图",url:"http://www.google.cn/maps/vt/pb=!1m4!1m3!1i{z}!2i{x}!3i{y}!2m3!1e0!2sm!3i380072576!3m8!2szh-CN!3scn!5e1105!12m4!1e68!2m2!1sset!2sRoadmap!4e0!5m1!1e0"})})]}),visible:!1},{id:"tiandi",name:"天地图电子",layer:new g.a({layers:[new y.a({zIndex:0,source:new v.a({title:"天地图路网",url:"http://t2.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}"})}),new y.a({zIndex:1,source:new v.a({title:"天地图文字标注",url:"http://t2.tianditu.com/DataServer?T=cva_w&x={x}&y={y}&l={z}"})})]}),visible:!1},{id:"tiandiS",name:"天地图卫星",layer:new g.a({layers:[new y.a({zIndex:0,source:new v.a({title:"天地图卫星",url:"http://t3.tianditu.com/DataServer?T=img_w&x={x}&y={y}&l={z}"})}),new y.a({source:new v.a({zIndex:1,title:"天地图文字标注",url:"http://t2.tianditu.com/DataServer?T=cva_w&x={x}&y={y}&l={z}"})})]}),visible:!1}],datalayers:[{id:"quyu",name:"行政区域",code:"zhhz:getRegion",type:"wmts",layer:{},zindex:2,visible:!1},{id:"heliu",name:"河流",code:"zhhz:getRiverAll",type:"wmts",layer:{},zindex:3,visible:!0},{id:"shuizha",name:"水闸",code:"zhhz:shuizha",layer:{},zindex:10,visible:!1},{id:"shuiyuandi",name:"水源地",code:"zhhz:shuiyuandi",layer:{},zindex:11,visible:!1},{id:"shuiku",name:"水库",code:"zhhz:shuiku",layer:{},zindex:12,visible:!1},{id:"shuijing",name:"水井",code:"zhhz:shuijing",layer:{},zindex:14,visible:!1},{id:"shuidz",name:"水电站",code:"zhhz:shuidz",layer:{},zindex:15,visible:!1},{id:"qushuikou",name:"取水口",code:"zhhz:qushuikou",layer:{},zindex:16,visible:!1},{id:"paiwukou",name:"排污口",code:"zhhz:paiwukou",layer:{},zindex:17,visible:!1},{id:"nongyin",name:"农饮工程",code:"zhhz:nongyin",layer:{},zindex:18,visible:!1},{id:"diba",name:"堤坝",code:"zhhz:diba",layer:{},zindex:19,visible:!1},{id:"bengzhan",name:"泵站",code:"zhhz:bengzhan",layer:{},zindex:20,visible:!1},{id:"zerenduan",name:"责任段",code:"zhhz:zerenduan",icon:"heliu",type:"wfs",layer:{},zindex:22,visible:!0},{id:"hupo",name:"湖泊山塘",code:"zhhz:hupo",type:"wfs",layer:{},zindex:4,visible:!0},{id:"dakadian",name:"打卡点",code:"zhhz:dakadian",type:"wfs",layer:{},style:function(e,t){return new k.c({stroke:new x.a({color:"green",width:2}),fill:new z.a({color:"rgba(255,0,0,0.2)"}),image:new I.a({anchor:[.5,32],anchorXUnits:"fraction",anchorYUnits:"pixels",size:[32,32],src:i("f1wY")}),text:new _.a({text:e.get("name"),offsetY:12,fill:new z.a({color:"#000"}),stroke:new x.a({color:"#fff",width:1})})})},zindex:23,visible:!1}]},$=i("4d7F"),G=i.n($),q=i("ouHB"),H=i("GvmM"),R=i("WDFe"),U=i("8vAs"),D=i("CvXi"),W=i("JW8z"),K=i("btgn"),Y=i("Inii"),J=i("1RAW"),Q=i("cV7i"),Z=i("eQqr"),X=i("ZNkr"),ee=null,te={getFeatureInfo:function(e){return Object(l.a)({url:e,method:"get",transformResponse:[function(e){return{success:!0,features:JSON.parse(e).features}}]})},initBgLayers:function(e,t){t.forEach(function(t){t.layer.set("code",t.id),t.layer.set("ltype","bg"),t.layer.setVisible(t.visible),e.addLayer(t.layer)})},switchBglayer:function(e,t,i){i.forEach(function(e){e.visible=!1,e.layer.setVisible(!1)}),t.visible=!0,t.layer.setVisible(!0)},getCapabilities:function(e){return new G.a(function(t,i){if(ee){var n=Object(J.b)(ee,{layer:e});t(n)}else Object(l.a)({url:P.wmtsServerUrl+"?Service=WMTS&Version=1.0.0&Request=GetCapabilities",method:"get",transformResponse:[function(e){return{success:!0,text:e}}]}).then(function(i){var n=(new Y.a).read(i.text);ee=n;var a=Object(J.b)(n,{layer:e});t(a)})})},createWMSTileLayer:function(e){return new y.a({source:new U.a({url:e.server||P.wmsServerUrl,crossOrigin:"anonymous",params:{VERSION:"1.1.1",LAYERS:e.code||e.id,TILED:!0},serverType:"geoserver",transition:0})})},createWFSTileLayer:function(e){return new s.a({source:new R.a({format:new q.a,url:function(t){return P.wfsServerUrl+"?service=WFS&version=1.1.0&request=GetFeature&typeName="+e.code+"&outputFormat=application/json&srsname="+P.projection+"&bbox="+t.join(",")+","+P.projection},strategy:Q.b}),style:e.style||C})},createWMTSTileLayer:function(e,t){var i=null,n=e.code||e.id;return this.getCapabilities(n).then(function(e){i=new y.a({opacity:.8,source:new J.a(e)}),t(i)}),i},createWMTSTileLayer2:function(e){for(var t=Object(W.c)("EPSG:900913"),i=Object(D.E)(t.getExtent())/256,n=[],a=[],o=0;o<=21;o++)n[o]="EPSG:900913:"+o,a[o]=i/Math.pow(2,o);var r=new K.b({origin:Object(D.C)(t.getExtent()),resolutions:a,matrixIds:n}),s=new J.a({url:P.wmtsServerUrl,layer:e.code||e.id,format:"image/png",projection:t,matrixSet:"shili_EPSG:900913",attributions:["©国土局"],tileGrid:r,style:""});return new y.a({opacity:.8,source:s})},initDataLayer:function(e,t){var i=this;t.forEach(function(t){t.layer instanceof H.a?(t.layer.set("code",t.id),t.layer.set("name",t.name),t.layer.get("ltype")||t.layer.set("ltype",t.type||"wms"),t.layer.setVisible(t.visible),e.addLayer(t.layer)):"wmts"===t.type?i.createWMTSTileLayer(t,function(i){t.layer=i,t.layer.set("code",t.id),t.layer.set("name",t.name),t.layer.set("ltype","wmts"),t.layer.setVisible(t.visible),e.addLayer(i)}):"wfs"===t.type?(t.layer=i.createWFSTileLayer(t),t.zindex&&t.layer.setZIndex(t.zindex),t.layer.set("code",t.id),t.layer.set("name",t.name),t.layer.set("ltype","wfs"),t.layer.setVisible(t.visible),e.addLayer(t.layer)):(t.layer=i.createWMSTileLayer(t),t.zindex&&t.layer.setZIndex(t.zindex),t.layer.set("code",t.id),t.layer.set("name",t.name),t.layer.set("ltype","wms"),t.layer.setVisible(t.visible),e.addLayer(t.layer))})},initBaseLayer:function(e){var t=new s.a({zIndex:98,source:new R.a({format:new q.a}),style:T});t.set("code","drawlayer"),t.set("ltype","base"),t.set("name","默认绘图层"),t.set("editable",!0);var i=new s.a({zIndex:99,source:new R.a({format:new q.a}),style:E});i.set("code","searchlayer"),i.set("ltype","base"),i.set("name","搜索结果层"),i.set("editable",!1);var n=new s.a({zIndex:100,source:new R.a({format:new q.a}),style:O});n.set("code","selectionDrawLayer"),n.set("ltype","base"),n.set("name","绘制选择框的图层"),n.set("editable",!1);var a=new s.a({zIndex:101,source:new R.a({format:new q.a}),style:V});a.set("code","markerLayer"),a.set("ltype","base"),a.set("name","个人标注图层"),a.set("editable",!0);var o=new s.a({zIndex:101,source:new R.a({format:new q.a}),style:N});o.set("code","meaLayer"),o.set("ltype","base"),o.set("name","量测图层"),o.set("editable",!0),e.addLayer(i),e.addLayer(t),e.addLayer(n),e.addLayer(a),e.addLayer(o)},getLayerByCode:function(e,t){var i=null;return e.getLayers().forEach(function(e,n,a){e.get("code")===t&&(i=e)}),i},formatLength:function(e){var t=Object(Z.c)(e,{projection:P.projection});return t>100?Math.round(t/1e3*100)/100+" km":Math.round(100*t)/100+" m"},formatArea:function(e){var t=Object(Z.a)(e,{projection:P.projection});return t>1e4?Math.round(t/1e6*100)/100+" km²":Math.round(100*t)/100+" m²"},toWKT:function(e){return this.wkt||(this.wkt=new X.a),this.wkt.writeGeometry(e)}},ie=i("rCk2"),ne=i("yAeK"),ae=i("svx0"),oe=i("LOJ/"),re=i("egkh"),se=i("TN97"),le=i("4wAk"),ce={selectGeom:function(e,t,i){this.map=e,this.featureName=i.name;var n=i.id;for(var a in n instanceof String&&(n=[n]),this.selectedFeatures||(this.selectedFeatures=[]),this.selectedFeatures){this.selectedFeatures[a].setStyle(null)}if(this.layer=this.getLayerByCode(t),this.layer)for(var o in n){if(this.featureId=n[o],this.fid=t+"."+this.featureId,this.selectedFeature=this.layer.getSource().getFeatureById(this.fid),console.log("",this.fid,this.selectedFeature),!this.selectedFeature)return;this.selectedFeature.setStyle(L),this.selectedFeatures.push(this.selectedFeature)}},removeGeom:function(e,t,i,n){if(this.map=e,this.featureId=i.id,this.callbackFunc=n,this.fid=t+"."+this.featureId,this.layer=this.getLayerByCode(t),this.layer){var a=this.layer.getSource();if(a instanceof R.a){var o=a.getFeatureById(this.fid);if(!o)return;a.removeFeature(o),this.callbackFunc("OK")}this.clean()}else console.log("没有绘制图层内容")},draw:function(e,t,i,n,a){var o=!0;this.map&&(o=!1),this.map=e,this.featureId=n.id,this.featureName=n.name,this.callbackFunc=a,this.geotype=t,this.fid=i+"."+this.featureId,this.layer=this.getLayerByCode(i),this.layer?this.layer.setVisible(!0):this.layer=this.getLayerByCode("drawlayer"),this.clean();var r=this.layer.getSource();if(r instanceof R.a){var s=r.getFeatureById(this.fid);s&&(console.log("对象已经存在,modify"),s.setStyle(T)),this.sketch=s,this.bindChangeLister(this.sketch)}else console.error("非Vector图层，不能绘图");this.initInteraction(o)},clean:function(){this.drawInteraction&&(this.map.removeInteraction(this.drawInteraction),this.map.removeInteraction(this.modifyInteraction),this.map.removeInteraction(this.snap),this.drawInteraction=null,this.modifyInteraction=null,this.snap=null),this.sketch&&(this.sketch.setStyle(null),this.unbindLister(this.sketch)),this.selectedFeature&&this.selectedFeature.setStyle(null)},bindChangeLister:function(e){if(e){var t=this;this.listener=e.getGeometry().on("change",function(e){var i,n=e.target;n instanceof w.a?i=t.formatArea(n):n instanceof re.a&&(i=t.formatLength(n)),t.callbackFunc("change",{feature:t.sketch,remarks:i,coord:n.getFirstCoordinate(),wkt:t.toWKT(n)})})}},unbindLister:function(e){this.listener&&e&&Object(f.b)(this.listener)},close:function(){this.clean()},initInteraction:function(e){this.initDraw(),this.initModify()},initDraw:function(){this.drawInteraction=new ie.a({source:this.layer.getSource(),type:this.geotype,geometryName:this.featureName}),this.map.addInteraction(this.drawInteraction),this.setDrawActive(!0),this.setModifyActive(!1);var e=this;this.drawInteraction.on("drawstart",function(t){e.sketch=t.feature,e.callbackFunc("start",{feature:e.sketch}),e.sketch.setId(e.fid),e.sketch.set("name",e.featureName),e.sketch.setStyle(T),e.bindChangeLister(e.sketch)},this),this.drawInteraction.on("drawend",function(){console.log("drawend……"),e.callbackFunc("end",{feature:e.sketch}),e.setDrawActive(!1),e.setModifyActive(!0)},this)},initModify:function(){if(this.sketch){var e=new le.a([this.sketch]);this.modifyInteraction=new ne.a({features:e}),this.map.addInteraction(this.modifyInteraction),this.setDrawActive(!1),this.setModifyActive(!0),this.setEvents();var t=new ae.a({features:e});this.map.addInteraction(t)}},setEvents:function(){},setModifyActive:function(e){!this.modifyInteraction&&this.sketch&&this.initModify(),this.modifyInteraction&&this.modifyInteraction.setActive(e)},setDrawActive:function(e){this.drawInteraction.setActive(e)},getLayerByCode:function(e){var t=null;return this.map.getLayers().forEach(function(i,n,a){i.get("code")===e&&(t=i)}),t},formatLength:function(e){var t=Object(Z.c)(e,{projection:P.projection});return t>100?Math.round(t/1e3*100)/100+" km":Math.round(100*t)/100+" m"},formatArea:function(e){var t=Object(Z.a)(e,{projection:P.projection});return t>1e4?Math.round(t/1e6*100)/100+" km²":Math.round(100*t)/100+" m²"},toWKT:function(e){return this.wkt||(this.wkt=new X.a),this.wkt.writeGeometry(e)}},ue={markPoint:function(e,t){this.parent=e,this.map=e.map,this.callbackFunc=t,this.layer=this.getLayerByCode("markerLayer"),this.initInteraction(),this.draw.setActive(!0),this.modifyInteraction.setActive(!0)},delMark:function(e,t){this.parent=e,this.layer=this.getLayerByCode("markerLayer"),this.layer.getSource().removeFeature(t)},showInputOverlay:function(e){if(e){this.inputOverlay||(this.inputOverlay=new p.a({element:document.getElementById("markpopup")}),this.map.addOverlay(this.inputOverlay));var t=e.getGeometry().getFirstCoordinate();this.inputOverlay.setPosition(t),this.parent.showMarkPopup({show:!0,name:e.get("name"),f:e})}},close:function(){this.draw&&(this.draw.setActive(!1),this.modifyInteraction.setActive(!1))},initInteraction:function(){if(!this.draw){this.draw=new ie.a({source:this.layer.getSource(),type:"Point"}),this.map.addInteraction(this.draw);var e=this;this.draw.on("drawstart",function(t){e.sketch=t.feature,e.count||(e.count=1),e.sketch.set("name","标注"+e.count),e.count=e.count+1}),this.draw.on("drawend",function(t){e.draw.setActive(!1),e.sketch=t.feature,e.callbackFunc({type:"end",coord:e.sketch.getGeometry().getFirstCoordinate(),f:e.sketch})}),this.select=new oe.a({layers:[this.layer],style:B}),this.select.set("code","marker"),this.map.addInteraction(this.select),this.modifyInteraction=new ne.a({features:this.select.getFeatures()}),this.map.addInteraction(this.modifyInteraction),this.modifyInteraction.setActive(!0),this.modifyInteraction.on("modifyend",function(t){t.features.getLength()>0&&(e.sketch=t.features.item(0),e.callbackFunc({type:"end",coord:e.sketch?e.sketch.getGeometry().getFirstCoordinate():null,f:e.sketch}))}),this.select.on("select",function(t){t.selected.length>0&&(e.sketch=t.selected[0],e.parent.hideMarkPopup(),setTimeout(function(){e.showInputOverlay(e.sketch)},100)),t.deselected.length>0&&e.sketch.setStyle(null)});var t=new ae.a({source:this.layer.getSource()});this.map.addInteraction(t)}},cleanInteraction:function(){var e=this;this.map.getInteractions().forEach(function(t,i,n){if(console.log(i,!!t&&t.getActive(),t),t instanceof ie.a||t instanceof ne.a||t instanceof ae.a)try{t.setActive(!1),e.map.removeInteraction(t)}catch(e){console.error(e.message)}})},getLayerByCode:function(e){var t=null;return this.map.getLayers().forEach(function(i,n,a){i.get("code")===e&&(t=i)}),t}},de={meaLine:function(e,t){this.geotype="LineString",this.init(e,t)},meaArea:function(e,t){this.geotype="Polygon",this.init(e,t)},init:function(e,t){this.parent=e,this.map=e.map,this.callbackFunc=t,this.layer=te.getLayerByCode(this.map,"meaLayer"),this.initVar(),this.initInteraction(),this.draw.setActive(!0),this.modifyInteraction.setActive(!0)},clean:function(){if(this.map){this.sketch=null,this.layer.getSource().clear(),Object(f.b)(this.pointermoveListener),Object(f.b)(this.mouseoutListener),Object(f.b)(this.listener),this.pointermoveListener=null,this.mouseoutListener=null;var e=this;this.map.getOverlays().forEach(function(t,i){t&&"meatext"===t.get("_type")&&e.map.removeOverlay(t)}),this.close()}},initVar:function(){if(this.sketch=null,this.helpTooltipElement,this.helpTooltip,this.measureTooltipElement,this.measureTooltip,this.continuePolygonMsg="单击，继续绘制多边形",this.continueLineMsg="单击，继续绘制线条",!this.pointermoveListener){this.createHelpTooltip();var e=this;this.pointermoveListener=this.map.on("pointermove",function(t){if(!t.dragging&&e.draw.getActive()){var i="单击开始";if(e.sketch){var n=e.sketch.getGeometry();n instanceof w.a?i=e.continuePolygonMsg:n instanceof re.a&&(i=e.continueLineMsg)}e.helpTooltipElement.className="tooltip tooltip-measure",e.helpTooltipElement.innerHTML=i,e.helpTooltip.setPosition(t.coordinate),e.helpTooltipElement.classList.remove("hidden")}}),this.mouseoutListener=this.map.getViewport().addEventListener("mouseout",function(){e.helpTooltipElement.classList.add("hidden")})}},close:function(){this.draw&&(this.draw.setActive(!1),this.modifyInteraction.setActive(!1))},initInteraction:function(){if(!this.draw){console.log("new draw interaction"),this.draw=new ie.a({source:this.layer.getSource(),type:this.geotype,style:N}),this.map.addInteraction(this.draw);var e=this;this.draw.on("drawstart",function(t){e.sketch=t.feature,e.count||(e.count=0),e.count=e.count+1;var i=e.count;e.sketch.set("code",i);var n=t.coordinate;e.measureTooltipElement=null,e.createMeasureTooltip(),e.sketch.getGeometry().set("_m_ele",e.measureTooltipElement),e.sketch.getGeometry().set("_m_tip",e.measureTooltip),e.measureTooltip.set("code",i),e.listener=e.sketch.getGeometry().on("change",function(e){var t,i=e.target;console.log("geom",te.toWKT(i)),i instanceof w.a?(t=te.formatArea(i),n=i.getInteriorPoint().getCoordinates()):i instanceof re.a&&(t=te.formatLength(i),n=i.getLastCoordinate());var a=i.get("_m_ele"),o=i.get("_m_tip");o&&(a.innerHTML=t,o.setPosition(n))})},this),this.draw.on("drawend",function(){e.measureTooltipElement.className="tooltip tooltip-measure",e.measureTooltip.setOffset([0,-7]),e.helpTooltipElement.innerHTML="",e.draw.setActive(!1)},this),this.modifyInteraction=new ne.a({source:this.layer.getSource()}),this.map.addInteraction(this.modifyInteraction);var t=new ae.a({source:this.layer.getSource()});this.map.addInteraction(t)}},createHelpTooltip:function(){console.log("new  HelpTooltip"),this.helpTooltipElement&&this.helpTooltipElement.parentNode.removeChild(this.helpTooltipElement),this.helpTooltipElement=document.createElement("div"),this.helpTooltipElement.className="tooltip hidden",this.helpTooltip=new p.a({element:this.helpTooltipElement,offset:[15,0],positioning:"center-left"}),this.helpTooltip.set("_type","helptext"),this.map.addOverlay(this.helpTooltip)},createMeasureTooltip:function(){this.measureTooltipElement&&this.measureTooltipElement.parentNode.removeChild(this.measureTooltipElement),this.measureTooltipElement=document.createElement("div"),this.measureTooltipElement.className="tooltip tooltip-measure",this.measureTooltip=new p.a({element:this.measureTooltipElement,offset:[0,-15],positioning:"bottom-center"}),this.measureTooltip.set("_type","meatext"),this.map.addOverlay(this.measureTooltip)}},he={playTrail:function(e,t){this.layerCode="searchlayer",this.init(e,t);var i=t.id,n=this.layerCode+"."+i;this.layer.getSource().getFeatureById(n)&&(this.geoMarkerStyle=F,this.startAnimation())},startAnimation:function(){var e=this,t=function(t){var n=t.vectorContext,a=t.frameState;if(e.animating){var o=a.time-e.now,r=Math.round(e.speed*o/1e3);if(r>=e.routeLength)return void i(!0);var s=new m.a(e.routeCoords[r]),l=new se.a(s);l.set("index",r),e.geoMarkerStyle.getText().setText(r+1),n.drawFeature(l,e.geoMarkerStyle)}e.map.render()},i=function(i){e.animating=!1;var n=i?e.routeCoords[e.routeLength-1]:e.routeCoords[0];e.geoMarker.getGeometry().setCoordinates(n),e.map.un("postcompose",t)};this.animating?i(!1):(this.animating=!0,this.now=(new Date).getTime(),this.speed=3,this.map.set("_speed",this.speed),this.geoMarker.setStyle(null),this.map.on("postcompose",t),this.map.render())},showTrail:function(e,t){this.layerCode="searchlayer",this.init(e,t);var i=t.id,n=this.layerCode+"."+i,a=this.wkt.readGeometry(t.wkt,{dataProjection:P.projection,featureProjection:P.projection}),o=this.layer.getSource().getFeatureById(n);if(!o){(o=new se.a({geometry:a,id:n,name:t.name})).setId(n),this.layer.getSource().addFeature(o);var r=a.getCoordinates(),s=r.length,l=new se.a({type:"trailMarker",gtype:"trail",name:"",geometry:new m.a(r[0])}),c=new se.a({type:"trailStart",gtype:"trail",name:"",geometry:new m.a(r[0])}),u=new se.a({type:"trailEnd",gtype:"trail",name:"",geometry:new m.a(r[s-1])});l.setStyle(null),this.geoMarker=l,this.routeCoords=r,this.routeLength=s,this.layer.getSource().addFeature(l),this.layer.getSource().addFeature(c),this.layer.getSource().addFeature(u)}o.set("gtype","trail"),o.set("type","trail")},showFeature:function(e,t){this.layerCode="searchlayer",this.init(e,t);var i=t.id,n=t.lng,a=t.lat,o=this.layerCode+"."+i,r=this.layer.getSource().getFeatureById(o);r||((r=new se.a({geometry:new m.a([n,a]),id:i,name:t.name})).setId(o),this.layer.getSource().addFeature(r)),r.set("gtype",t.gtype)},init:function(e,t){this.parent=e,this.map=e.map,this.options=t,this.layer=te.getLayerByCode(this.map,this.layerCode),this.layer?this.layer.setVisible(!0):console.error("图层不存在，",this.layerCode),this.wkt||(this.wkt=new X.a)},clean:function(){this.map&&this.close()},close:function(){}},me=i("wkzA"),pe=(i("Add6"),[{element:"#mapctrl",popover:{title:"操作工具栏",description:"图形操作区域，包括工具栏开关、图层管理开关。<br><br>绘图模式下，绘图按键：<p><ol><li>点击，开始绘图，或添加点；</li><li>双击，完成绘图；</li><li>Alt+点击，删除连接节点；</li><li> Shift+拖动鼠标，任意绘图；</li></ol></p>",position:"left"}},{element:"#map-btn-toolbar",popover:{title:"工具栏",description:"图形操作工具栏，包括对象编辑、测距、标注等常用操作",position:"left"}},{element:"#map-btn-browse",popover:{title:"选择操作",description:"选择操作，将退出地图的其其它编辑环境，回到地图浏览模式。",position:"bottom"}},{element:"#map-btn-clean",popover:{title:"清除",description:"清除地图中所有的绘制内容",position:"bottom"}},{element:"#map-btn-mea",popover:{title:"测距",description:"测量多个连接点之间的实际距离",position:"bottom"}},{element:"#map-btn-mark",popover:{title:"标注",description:"在地图上标注点，方便快速查找",position:"left"}},{element:"#map-btn-help",popover:{title:"帮助",description:"帮助菜单入口",position:"left"}},{element:"#map-btn-layer",popover:{title:"图层管理",description:"地图所有图层列表，点击选中或取消选中图层",position:"left"}}]),fe={name:"RmMap",props:{id:{required:!1,default:"map-"+Math.floor(1e3*Math.random()+1)},value:{required:!1},clientHeight:{required:!1,type:Number,default:0}},data:function(){return{v:{ctrl:!1,tool:!1},map:null,pointmoveListner:null,clickListner:null,bglayers:[],datalayers:[],activeNames:["datalayer","bglayer"],marker:{show:!1,name:""},propanel:{show:!1,list:[]},driver:null}},computed:{ClientHeigth:function(){var e=void 0;if(this.clientHeight)e=this.clientHeight;else{e=this.getHeight(window)-84;var t=this;window.onresize=function(){e=t.getHeight(window)-84}}return e}},watch:{},mounted:function(){this.initMap(),this.driver=new me({doneBtnText:"完成",closeBtnText:"关闭",nextBtnText:"下一个",prevBtnText:"上一个"})},beforeDestroy:function(){this.pointmoveListner&&(Object(f.b)(this.pointmoveListner),this.map.un("pointermove",this.pointmoveListner),this.pointmoveListner=null),this.clickListner&&(Object(f.b)(this.clickListner),this.map.un("singleclick",this.clickListner),this.clickListner=null)},methods:{showFeature:function(e){this.resetAction(),e.zoomView||this.centerView([e.lng,e.lat],15),he.showFeature(this,e)},showTrail:function(e){this.resetAction(),e.lng&&this.centerView([e.lng,e.lat],15),he.showTrail(this,e)},playTrail:function(e){this.resetAction(),he.playTrail(this,e)},selectLine:function(e){this.resetAction(),e.lng&&this.centerView([e.lng,e.lat],16),ce.selectGeom(this.map,"zerenduan",e)},drawLine:function(e,t){this.resetAction(),ce.draw(this.map,"LineString","zerenduan",e,t)},removeLine:function(e,t){ce.removeGeom(this.map,"zerenduan",e,t)},drawArea:function(e,t){this.resetAction(),ce.draw(this.map,"Polygon","hupo",e,t)},removeHupo:function(e,t){ce.removeGeom(this.map,"hupo",e,t)},drawDakadian:function(e,t){this.resetAction(),ce.draw(this.map,"Point","dakadian",e,t)},removeDakadian:function(e,t){ce.removeGeom(this.map,"dakadian",e,t)},resetAction:function(){de.close(),ce.close(),ue.close()},cleanDraw:function(){de.clean(),this.resetAction()},meaLine:function(){this.resetAction();de.meaLine(this,function(e){console.log("回调，测距",e)})},newMarker:function(){this.resetAction();ue.markPoint(this,function(e){console.log("回调，标注",e)})},showMarkPopup:function(e){this.marker=e},hideMarkPopup:function(){this.marker.show=!1},updateMarker:function(){this.marker.f.set("name",this.marker.name),this.marker.show=!1},delMarker:function(){ue.delMark(this,this.marker.f),this.marker.show=!1},help:function(){this.driver.defineSteps(pe),this.driver.start()},resetView:function(){this.centerView(P.center,P.zoom)},centerView:function(e,t){if(t=void 0===t?16:t,e[0]&&e[1]){var i=new m.a(e);this.map.getView().fit(i,{padding:[100,100,100,100],constrainResolution:!1,nearest:!1,maxZoom:t,duration:2e3})}},showProperties:function(e,t){var i=this;this.propanel.show=!1,Object(l.a)({url:"/api/res/river/sourcecomment",method:"get",params:{id:e,type:t}}).then(function(e){i.propanel.list=e.data.list,i.propanel.show=!0})},switchDatalayer:function(e){e.visible=!e.visible,e.layer.setVisible(e.visible)},switchBglayer:function(e){e.visible=!0,te.switchBglayer(this.map,e,P.bglayers)},initMap:function(){this.map=new o.a({target:this.$refs.mapid,controls:Object(c.a)({attribution:!0,attributionOptions:{collapsible:!0},zoomOptions:{zoomInTipLabel:"放大",zoomOutTipLabel:"缩小"}}).extend([new u.a({units:"metric"}),new d.a({coordinateFormat:Object(h.d)(4),projection:"EPSG:4326",undefinedHTML:"&nbsp;"})]),layers:[],view:new r.a({center:P.center,projection:P.projection,minZoom:P.minZoom,zoom:P.zoom})});var e=P.bglayers,t=JSON.parse(a()(P.datalayers));te.initBgLayers(this.map,e),te.initBaseLayer(this.map),te.initDataLayer(this.map,t),this.bglayers=e,this.datalayers=t,this.proOverlay||(this.proOverlay=new p.a({element:document.getElementById("propopup")}),this.map.addOverlay(this.proOverlay));var i=this;this.clickListner=this.map.on("singleclick",function(e){var t=i.map.getEventPixel(e.originalEvent),n=i.map.getView().getResolution();i.map.forEachLayerAtPixel(t,function(t){if(t instanceof s.a){var a=t.getSource().getClosestFeatureToCoordinate(e.coordinate);i.$emit("clickHandle",{type:a.get("gtype"),id:a.get("id"),name:a.get("name"),x:e.originalEvent.x,y:e.originalEvent.y})}else{var o=t.getSource().getGetFeatureInfoUrl(e.coordinate,n,P.projection,{INFO_FORMAT:"application/json"});o&&te.getFeatureInfo(o).then(function(t){if(t.features.length>0){var n=t.features[0];console.log(n.properties.id,n.properties.name),i.showProperties(n.properties.id,n.properties.gtype),i.proOverlay.setPosition(e.coordinate)}})}return!0},{layerFilter:function(e){return"wms"===e.get("ltype")||"base"===e.get("ltype")},hitTolerance:10})}),this.pointmoveListner=this.map.on("pointermove",function(e){if(!e.dragging)try{var t=i.map.getEventPixel(e.originalEvent),n=i.map.forEachLayerAtPixel(t,function(e){return!0},{layerFilter:function(e){return"wms"===e.get("ltype")||"base"===e.get("ltype")},hitTolerance:10});i.map.getTargetElement().style.cursor=n?"pointer":""}catch(e){}}),this.$emit("input",this)}}},ge=(i("2iLR"),i("KHd+")),ye=Object(ge.a)(fe,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mapContainer"},[n("div",{ref:"mapid",staticClass:"map",style:{height:e.ClientHeigth+"px"}}),e._v(" "),n("div",{staticClass:"map-ctrl-panel",attrs:{id:"mapctrl"}},[n("el-popover",{attrs:{"popper-class":"map-ctrl-tool",width:"460",placement:"left","visible-arrow":"false",trigger:"manual"},model:{value:e.v.tool,callback:function(t){e.$set(e.v,"tool",t)},expression:"v.tool"}},[n("el-button-group",[n("el-button",{attrs:{id:"map-btn-resetview",title:"还原视图",size:"mini"},on:{click:function(t){e.resetView()}}},[n("svg-icon",{attrs:{"icon-class":"map-revert"}})],1),e._v(" "),n("el-button",{attrs:{id:"map-btn-browse",title:"浏览模式",size:"mini"},on:{click:e.resetAction}},[n("svg-icon",{attrs:{"icon-class":"map-pointer"}})],1),e._v(" "),n("el-button",{attrs:{title:"新增",icon:"el-icon-plus",size:"mini",disabled:""}}),e._v(" "),n("el-button",{attrs:{title:"编辑",icon:"el-icon-edit",size:"mini",disabled:""}}),e._v(" "),n("el-button",{attrs:{id:"map-btn-clean",title:"清除绘制操作",icon:"el-icon-delete",size:"mini"},on:{click:e.cleanDraw}}),e._v(" "),n("el-button",{attrs:{id:"map-btn-mea",title:"测距",size:"mini"},on:{click:e.meaLine}},[n("svg-icon",{attrs:{"icon-class":"map-mea"}})],1),e._v(" "),n("el-button",{attrs:{id:"map-btn-mark",title:"标注",icon:"el-icon-location-outline",size:"mini"},on:{click:function(t){e.newMarker()}}}),e._v(" "),n("el-button",{attrs:{id:"map-btn-help",title:"帮助",icon:"el-icon-question",size:"mini"},on:{click:e.help}})],1),e._v(" "),n("el-button",{staticClass:"map-ctrl-btn",attrs:{slot:"reference",id:"map-btn-toolbar",title:"工具栏"},on:{click:function(t){e.v.tool=!e.v.tool}},slot:"reference"},[n("svg-icon",{attrs:{"icon-class":"map-tool"}})],1)],1),e._v(" "),n("el-popover",{attrs:{title:"图层管理",width:"400",placement:"left-end",trigger:"click"},model:{value:e.v.ctrl,callback:function(t){e.$set(e.v,"ctrl",t)},expression:"v.ctrl"}},[n("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[n("el-collapse-item",{attrs:{title:"数据图层",name:"datalayer"}},e._l(e.datalayers,function(t){return n("div",{key:t.value,staticClass:"map-c-layer-box",class:{active:t.visible},on:{click:function(i){e.switchDatalayer(t)}}},[n("img",{attrs:{src:i("jm3+")("./"+(t.icon||t.id)+".png")}}),e._v(" "),n("span",[e._v(e._s(t.name))])])})),e._v(" "),n("el-collapse-item",{attrs:{title:"底图图层",name:"bglayer"}},e._l(e.bglayers,function(t){return n("div",{key:t.value,staticClass:"map-c-layer-box",class:{active:t.visible},on:{click:function(i){e.switchBglayer(t)}}},[n("img",{attrs:{src:i("jm3+")("./"+t.id+".png")}}),e._v(" "),n("span",[e._v(e._s(t.name))])])}))],1),e._v(" "),n("el-button",{staticClass:"map-ctrl-btn",attrs:{slot:"reference",id:"map-btn-layer",title:"地图图层"},slot:"reference"},[n("svg-icon",{attrs:{"icon-class":"map-layer"}})],1)],1)],1),e._v(" "),n("el-popover",{attrs:{placement:"right",offset:"30",title:"标注",width:"250",trigger:"manual"},model:{value:e.marker.show,callback:function(t){e.$set(e.marker,"show",t)},expression:"marker.show"}},[n("p",[n("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.marker.name,callback:function(t){e.$set(e.marker,"name",t)},expression:"marker.name"}})],1),e._v(" "),n("div",{staticStyle:{"text-align":"right","margin-top":"30px"}},[n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){e.delMarker()}}},[e._v("删除")]),e._v(" "),n("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(t){e.marker.show=!1}}},[e._v("关闭")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.updateMarker()}}},[e._v("确定")])],1),e._v(" "),n("div",{attrs:{slot:"reference",id:"markpopup"},slot:"reference"})]),e._v(" "),n("el-popover",{attrs:{placement:"right",offset:"30",title:"资源属性",width:"550",height:"500px",trigger:"manual"},model:{value:e.propanel.show,callback:function(t){e.$set(e.propanel,"show",t)},expression:"propanel.show"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.propanel.list,stripe:"","show-header":!1,"max-height":"350"}},[n("el-table-column",{attrs:{type:"index"}}),e._v(" "),n("el-table-column",{attrs:{prop:"label",label:"属性",width:"150",align:"left"}}),e._v(" "),n("el-table-column",{attrs:{prop:"value",label:"值",align:"left"}})],1),e._v(" "),n("div",{staticStyle:{"text-align":"right",margin:"10px"}},[n("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(t){e.propanel.show=!1}}},[e._v("关闭")])],1),e._v(" "),n("div",{attrs:{slot:"reference",id:"propopup"},slot:"reference"})],1)],1)},[],!1,null,"536882c0",null);ye.options.__file="index.vue";t.a=ye.exports},PLwA:function(e,t,i){"use strict";var n={name:"PanThumb",props:{image:{type:String,required:!0},zIndex:{type:Number,default:1},width:{type:String,default:"150px"},height:{type:String,default:"150px"}}},a=(i("ooQp"),i("KHd+")),o=Object(a.a)(n,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"pan-item",style:{zIndex:this.zIndex,height:this.height,width:this.width}},[t("div",{staticClass:"pan-info"},[t("div",{staticClass:"pan-info-roles-container"},[this._t("default")],2)]),this._v(" "),t("img",{staticClass:"pan-thumb",attrs:{src:this.image}})])},[],!1,null,"2ec399ff",null);o.options.__file="index.vue";t.a=o.exports},QeyH:function(e,t,i){"use strict";var n=i("T+Vt");i.n(n).a},RUFa:function(e,t,i){"use strict";var n=i("dxWy");i.n(n).a},"T+Vt":function(e,t,i){},T0uj:function(e,t,i){},UJM3:function(e,t,i){"use strict";var n=i("rDVo");i.n(n).a},UjA4:function(e,t,i){"use strict";var n=i("gDS+"),a=i.n(n),o=i("cCY5"),r=i.n(o),s=(i("VCwm"),i("GiAY")),l={components:{Treeselect:r.a},name:"RmOrgSelect",props:{value:{required:!1},format:{required:!1,type:String,default:"object"},multiple:{required:!1,type:Boolean,default:!1},autoload:{required:!1,type:Boolean,default:!1}},data:function(){return{orgs:null,normalizer:function(e){return e.label=e.label||e.name,e}}},computed:{},methods:{handleInput:function(e,t){console.log(a()(e)),this.$emit("input",e)},handleSelect:function(e,t){this.multiple?(this.value.push(e),this.$emit("input",this.value)):this.$emit("input",e)},loadOrgs:function(e){var t=e.action,i=e.parentNode,n=e.callback,a=this,o=null;"LOAD_ROOT_OPTIONS"!==t&&(o=i.id),Object(s.b)(o).then(function(e){var t=e.data.list;if(0===t.length)return o&&(i.children=void 0),void n();var r=[];for(var s in t)r.push({id:t[s].id,name:t[s].name,label:t[s].name,children:null}),o?i.children=r:a.orgs=r,n()}).catch(function(e){console.log(e),n()})}}},c=(i("RUFa"),i("KHd+")),u=Object(c.a)(l,function(){var e=this,t=e.$createElement;return(e._self._c||t)("treeselect",{attrs:{"load-options":e.loadOrgs,options:e.orgs,"auto-load-root-options":e.autoload,value:e.value,multiple:e.multiple,"value-consists-of":"LEAF_PRIORITY","no-children-text":"空记录","retry-text":"重试","value-format":e.format,placeholder:"选择部门...",normalizer:e.normalizer},on:{input:e.handleInput}})},[],!1,null,"3b89c11b",null);u.options.__file="index.vue";t.a=u.exports},aHhz:function(e,t,i){},dxWy:function(e,t,i){},glbJ:function(e,t,i){"use strict";var n=i("4d7F"),a=i.n(n),o=i("GQeE"),r=i.n(o),s={name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[]}},methods:{checkAllSuccess:function(){var e=this;return r()(this.listObj).every(function(t){return e.listObj[t].hasSuccess})},handleSubmit:function(){var e=this,t=r()(this.listObj).map(function(t){return e.listObj[t]});this.checkAllSuccess()?(this.$emit("successCBK",t),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("请等待所有图片上传成功 或 出现了网络问题，请刷新页面重新上传！")},handleSuccess:function(e,t){for(var i=t.uid,n=r()(this.listObj),a=0,o=n.length;a<o;a++)if(this.listObj[n[a]].uid===i)return this.listObj[n[a]].url=e.files.file,void(this.listObj[n[a]].hasSuccess=!0)},handleRemove:function(e){for(var t=e.uid,i=r()(this.listObj),n=0,a=i.length;n<a;n++)if(this.listObj[i[n]].uid===t)return void delete this.listObj[i[n]]},beforeUpload:function(e){var t=this,i=window.URL||window.webkitURL,n=e.uid;return this.listObj[n]={},new a.a(function(a,o){var r=new Image;r.src=i.createObjectURL(e),r.onload=function(){t.listObj[n]={hasSuccess:!1,uid:e.uid,width:this.width,height:this.height}},a(!0)})}}},l=(i("QeyH"),i("KHd+")),c=Object(l.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"upload-container"},[i("el-button",{style:{background:e.color,borderColor:e.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("上传图片\n  ")]),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-upload",{staticClass:"editor-slide-upload",attrs:{multiple:!0,"file-list":e.fileList,"show-file-list":!0,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"before-upload":e.beforeUpload,action:"https://httpbin.org/post","list-type":"picture-card"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1),e._v(" "),i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)},[],!1,null,"42cdae20",null);c.options.__file="editorImage.vue";var u=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools importcss insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],d=["bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],h={name:"Tinymce",components:{editorImage:c.exports},props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:Number,required:!1,default:360}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN"}}},computed:{language:function(){return this.languageTypeList[this.$store.getters.language]}},watch:{value:function(e){var t=this;!this.hasChange&&this.hasInit&&this.$nextTick(function(){return window.tinymce.get(t.tinymceId).setContent(e||"")})},language:function(){var e=this;this.destroyTinymce(),this.$nextTick(function(){return e.initTinymce()})}},mounted:function(){this.initTinymce()},activated:function(){this.initTinymce()},deactivated:function(){this.destroyTinymce()},destroyed:function(){this.destroyTinymce()},methods:{initTinymce:function(){var e=this,t=this;window.tinymce.init({language:this.language,selector:"#"+this.tinymceId,height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:d,menubar:this.menubar,plugins:u,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:function(i){t.value&&i.setContent(t.value),t.hasInit=!0,i.on("NodeChange Change KeyUp SetContent",function(){e.hasChange=!0,e.$emit("input",i.getContent())})},setup:function(e){e.on("FullscreenStateChanged",function(e){t.fullscreen=e.state})}})},destroyTinymce:function(){window.tinymce.get(this.tinymceId)&&window.tinymce.get(this.tinymceId).destroy()},setContent:function(e){window.tinymce.get(this.tinymceId).setContent(e)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(e){var t=this;e.forEach(function(e){window.tinymce.get(t.tinymceId).insertContent('<img class="wscnph" src="'+e.url+'" >')})}}},m=(i("znMc"),Object(l.a)(h,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tinymce-container editor-container",class:{fullscreen:this.fullscreen}},[t("textarea",{staticClass:"tinymce-textarea",attrs:{id:this.tinymceId}}),this._v(" "),t("div",{staticClass:"editor-custom-btn-container"},[t("editorImage",{staticClass:"editor-upload-btn",attrs:{color:"#1890ff"},on:{successCBK:this.imageSuccessCBK}})],1)])},[],!1,null,"5002cbfe",null));m.options.__file="index.vue";t.a=m.exports},"h6z/":function(e,t,i){},hGIS:function(e,t,i){"use strict";var n=i("oQW0");i.n(n).a},hWHG:function(e,t,i){"use strict";var n=i("gDS+"),a=i.n(n),o=i("cCY5"),r=i.n(o),s=(i("VCwm"),i("iQb1")),l={components:{Treeselect:r.a},name:"RmAreaSelect",props:{value:{required:!1},format:{required:!1,type:String,default:"object"},multiple:{required:!1,type:Boolean,default:!1},autoload:{required:!1,type:Boolean,default:!1},defaultExpand:{required:!1,type:Number,default:0}},data:function(){return{areas:null,normalizer:function(e){return e.label=e.label||e.name,e}}},computed:{},created:function(){},methods:{handleInput:function(e,t){console.log("value",a()(e)),this.$emit("input",e)},handleSelect:function(e,t){console.log("node:",e),console.log("instanceId:",t),this.multiple?(this.value.push(e),this.$emit("input",this.value)):this.$emit("input",e)},loadAreas:function(e){var t=e.action,i=e.parentNode,n=e.callback;console.log(t,i,n);var a=this,o=null;"LOAD_ROOT_OPTIONS"!==t&&(o=i.id),Object(s.a)(o).then(function(e){var t=e.data.list;if(0===t.length)return o&&(i.children=void 0),void n();a.areas=t,a.areas.children.length>0?areas=open:areas=close,n()}).catch(function(e){console.log(e),n()})}}},c=(i("JThA"),i("KHd+")),u=Object(c.a)(l,function(){var e=this,t=e.$createElement;return(e._self._c||t)("treeselect",{attrs:{"load-options":e.loadAreas,options:e.areas,"auto-load-root-options":e.autoload,value:e.value,multiple:e.multiple,"value-consists-of":"LEAF_PRIORITY","no-children-text":"空记录","retry-text":"重试","value-format":e.format,placeholder:"选择部门...",normalizer:e.normalizer,defaultExpandLevel:e.defaultExpand},on:{input:e.handleInput}})},[],!1,null,"5513e108",null);u.options.__file="index.vue";t.a=u.exports},iG3g:function(e,t,i){},oQW0:function(e,t,i){},ooQp:function(e,t,i){"use strict";var n=i("T0uj");i.n(n).a},rDVo:function(e,t,i){},thBn:function(e,t,i){"use strict";var n=i("aHhz");i.n(n).a},uARZ:function(e,t,i){"use strict";var n={name:"Sticky",props:{stickyTop:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String,default:""}},data:function(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted:function(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleReize)},activated:function(){this.handleScroll()},destroyed:function(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleReize)},methods:{sticky:function(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},reset:function(){this.active&&(this.position="",this.width="auto",this.active=!1,this.isSticky=!1)},handleScroll:function(){this.width=this.$el.getBoundingClientRect().width,this.$el.getBoundingClientRect().top<this.stickyTop?this.sticky():this.reset()},handleReize:function(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}},a=i("KHd+"),o=Object(a.a)(n,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{style:{height:e.height+"px",zIndex:e.zIndex}},[i("div",{class:e.className,style:{top:e.stickyTop+"px",zIndex:e.zIndex,position:e.position,width:e.width,height:e.height+"px"}},[e._t("default",[i("div",[e._v("sticky")])])],2)])},[],!1,null,null,null);o.options.__file="index.vue";t.a=o.exports},"vc+U":function(e,t,i){"use strict";var n=i("gDS+"),a=i.n(n),o=i("cCY5"),r=i.n(o),s=(i("VCwm"),i("GiAY")),l={components:{Treeselect:r.a},name:"RmUserSelect",props:{value:{required:!1},format:{required:!1,type:String,default:"object"},multiple:{required:!1,type:Boolean,default:!1},autoload:{required:!1,type:Boolean,default:!0}},data:function(){return{orgusers:null,normalizer:function(e){return e.label=e.label||e.name,e}}},computed:{},methods:{handleInput:function(e,t){var i=e;if(i.oid){var n=a()(e);(i=JSON.parse(n)).id=i.oid,delete i.oid}this.$emit("input",i)},handleDeselect:function(e,t){},handleSelect:function(e,t){var i=a()(e),n=JSON.parse(i);n.id=n.oid,delete n.oid,this.multiple?this.$emit("input",this.value):this.$emit("input",n)},loadUserOrgs:function(e){var t=e.action,i=e.parentNode,n=e.callback,a=this,o=null;"LOAD_ROOT_OPTIONS"!==t&&(o=i.oid),Object(s.a)(o).then(function(e){var t=e.data,r=t.offices,s=t.users;if(0===r.length)return o&&(i.children=[]),i.isDisabled=!0,void n();var l=[];for(var c in r)l.push({id:"o"+r[c].id,oid:r[c].id,name:r[c].name,label:r[c].name,children:null});for(var u in s)l.push({id:"u"+s[u].id,oid:s[u].id,name:s[u].name,label:s[u].name,children:void 0});o?i.children=l:a.orgusers=l,n()}).catch(function(e){console.log(e),n()})}}},c=(i("hGIS"),i("KHd+")),u=Object(c.a)(l,function(){var e=this,t=e.$createElement;return(e._self._c||t)("treeselect",{attrs:{"load-options":e.loadUserOrgs,options:e.orgusers,"auto-load-root-options":e.autoload,value:e.value,multiple:e.multiple,"disable-branch-nodes":!0,"show-count":!1,"value-consists-of":"LEAF_PRIORITY","no-children-text":"空记录","retry-text":"重试","value-format":e.format,placeholder:"选择用户...",normalizer:e.normalizer},on:{input:e.handleInput}})},[],!1,null,"55d45690",null);u.options.__file="index.vue";t.a=u.exports},znMc:function(e,t,i){"use strict";var n=i("AL3+");i.n(n).a}}]);