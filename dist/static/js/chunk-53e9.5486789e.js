(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-53e9"],{GiAY:function(e,t,o){"use strict";o.d(t,"b",function(){return l}),o.d(t,"a",function(){return i});var a=o("t3Un");function l(e){return Object(a.a)({url:"/api/sys/office/list",method:"get",params:{id:e}})}function i(e){return Object(a.a)({url:"/api/sys/office/childs",method:"get",params:{pid:e}})}},Hzbd:function(e,t,o){"use strict";o.r(t);var a=o("P2sY"),l=o.n(a),i=o("t3Un");function r(e){return Object(i.a)({url:"/api/sys/office/dutybyofficeid",method:"get",params:e})}var s=o("Mz3J"),n=o("4A2f"),c=o("UjA4"),m=o("vc+U"),u=o("hWHG"),d={name:"UserManagement",components:{Pagination:s.a,RmDict:n.a,RmOrgSelect:c.a,RmUserSelect:m.a,RmAreaSelect:u.a},data:function(){var e=this,t=function(t,o,a){""===o?a(new Error("请输入密码")):(""!==e.form.checkPass&&e.$refs.form.validateField("checkPass"),a()),o&&o.lemgth<6&&a(new Error("密码小于6个字符"))};return{postArray:[],loading:!0,tableLoading:!1,checked:!1,dataArray:[],dialogVisible:!1,dialogVisible1:!1,dialogVisible2:!1,defaultProps:{children:"children",label:"label"},listQuery:{name:"",state:"",role:"",pageNo:1,pageSize:10,id:""},unit:"","company.id":"",form:{dept:null,loginName:null,name:null,password:null,checkPass:"",sort:null,mobile:null,gender:null,state:null,post:null,email:null,id:null},rules:{post:[{required:!0,message:"请选择岗位",trigger:"change"}],loginName:[{required:!0,message:"请填写登录账号",trigger:"blur"}],name:[{required:!0,message:"请填写您的姓名",trigger:"blur"},{min:2,max:4,message:"长度在 3 到 10 个字符",trigger:"blur"}],password:[{validator:t,trigger:"blur"}],checkPass:[{validator:function(t,o,a){""===o?a(new Error("请再次输入密码")):o!==e.form.password?a(new Error("两次输入密码不一致!")):a()},trigger:"blur"}],sort:[{required:!0,message:"序号是必填的",trigger:"change"}],mobile:[{required:!0,message:"请填写手机号码",trigger:"change"}],state:[{required:!0,message:"请选择状态",trigger:"change"}]},form2:{oldPassword:"",newPassword:"",checkPass:""},rules2:{newPassword:[{validator:t,trigger:"blur"}],checkPass:[{validator:function(t,o,a){""===o?a(new Error("请再次输入密码")):o!==e.form2.newPassword?a(new Error("两次输入密码不一致!")):a()},trigger:"blur"}]},total:0,states:["正常","停用"],roles:["巡河长","张三","李四","王五","赵六"],tableData3:[],multipleSelection:[]}},created:function(){this.loadLeftTree()},methods:{loadLeftTree:function(){var e=this;(function(e){return Object(i.a)({url:"api/res/management/areaofficetrees",method:"get",params:e})})().then(function(t){var o=t.data.list;e.dataArray=o,e.listQuery["office.id"]=o[0].id,e.unit=o[0].label,e.deptObj={id:o[0].id},e.getList(),e.loading=!1}).catch(function(t){e.loading=!1,e.$message({type:"error",message:t})})},onlyShowSelectBtn:function(e){console.log("只显示所属单位",e)},handleNodeClick:function(e){console.log("节点信息",e),this.unit=e.label,console.log("this.form.unit",this.unit),this.listQuery["office.id"]=e.id;var t={id:e.id};this.deptObj=t,this.getList()},handleEdit:function(e,t){var o=this;r({id:this.listQuery["office.id"]}).then(function(e){o.postArray=e.data.list}).catch(function(e){}),this.form=t,this.dialogVisible1=!0,console.log("表单编辑",t)},ModifyPassword:function(e,t){console.log(e,t),void 0!=this.$refs.form2&&this.$refs.form2.resetFields(),this.dialogVisible2=!0},savePass:function(){var e=this;(function(e){return Object(i.a)({url:"/api/sys/user/pwd",method:"post",data:e})})(this.form2).then(function(t){e.dialogVisible2=!1,e.$message({type:"success",message:"成功修改密码!"})}).catch(function(t){e.dialogVisible2=!1})},handleStart:function(e,t){var o=this,a={id:t.id};"1"==t.state?a.state=0:"0"==t.state&&(a.state=1),function(e){return Object(i.a)({url:"/api/sys/user/state",method:"post",data:e})}(a).then(function(e){o.$message({type:"success",message:"修改成功!"}),o.getList()}).catch(function(e){})},getList:function(){var e=this;this.tableLoading=!0,function(e){return Object(i.a)({url:"/api/sys/user/list",method:"get",params:e})}(this.listQuery).then(function(t){console.log("表单列表",t),e.tableData3=t.data.list,e.total=t.data.count,e.tableLoading=!1}).catch(function(t){e.tableLoading=!1})},searchBtn:function(){console.log("这是查询啊"),this.listQuery.pageNo=1,this.getList()},addBtn:function(){var e=this;r({id:this.listQuery["office.id"]}).then(function(t){e.postArray=t.data.list}).catch(function(e){}),console.log("添加的---之前",this.unit),this.dialogVisible=!0,void 0!=this.$refs.form&&l()(this.form,this.$options.data().form),this.form.dept=this.deptObj,console.log("添加的---",this.unit)},deleteBtn:function(){var e=this;if(this.multipleSelection.length>0){var t=[];this.multipleSelection.map(function(e){t.push(e.id)});var o=t.join();console.log("idStr",o),this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(e){return Object(i.a)({url:"/api/sys/user/del",method:"get",params:e})})(o).then(function(t){e.AreaTree(),e.$message({type:"success",message:"删除成功!"})}).catch(function(e){})}).catch(function(){})}else this.$message({type:"warn",message:"请先勾选!"})},save:function(e){var t=this;this.dialogVisible=!1,console.log(this.form);var o={"company.id":"system","office.id":this.form.dept.id};this.form.loginName&&(o.loginName=this.form.loginName),this.form.name&&(o.name=this.form.name),this.form.email&&(o.email=this.form.email),this.form.gender&&(o.gender=this.form.gender),this.form.id&&(o.id=this.form.id),this.form.mobile&&(o.mobile=this.form.mobile),this.form.post&&(o.post=this.form.post),this.form.state&&(o.state=this.form.state),console.log("编辑新增的params",o),function(e){return Object(i.a)({url:"/api/sys/user/save",method:"post",data:e})}(o).then(function(e){t.getList(),t.dialogVisible1=!1}).catch(function(e){t.dialogVisible1=!1})},toggleSelection:function(e){var t=this;e?e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(e){this.multipleSelection=e}}},f=(o("Nb5J"),o("VkuR"),o("KHd+")),p=Object(f.a)(d,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container userM"},[o("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[o("el-aside",[o("div",{staticClass:"panel"},[o("div",{staticClass:"panelHeading"},[o("div",[e._v("\n            单位\n          ")]),e._v(" "),o("div",[o("el-checkbox",{on:{change:e.onlyShowSelectBtn},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("仅显示所选单位用户")])],1)]),e._v(" "),o("div",{staticClass:"source panel-body"},[o("el-tree",{attrs:{data:e.dataArray,props:e.defaultProps,"empty-text":"暂无数据","highlight-current":""},on:{"node-click":e.handleNodeClick}})],1)])]),e._v(" "),o("el-container",[o("el-header",{attrs:{height:"125px"}},[o("div",{staticClass:"topTitle"},[e._v("\n          用户列表\n        ")]),e._v(" "),o("div",{staticClass:"filter-container"},[o("el-input",{staticClass:"filter-item",staticStyle:{width:"210px"},attrs:{placeholder:"输入姓名、帐号或电话搜索..."},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchBtn(t):null}},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}}),e._v("\n          状态：\n          "),o("el-select",{staticClass:"filter-item",staticStyle:{width:"140px"},attrs:{placeholder:"请选择状态",clearable:""},model:{value:e.listQuery.state,callback:function(t){e.$set(e.listQuery,"state",t)},expression:"listQuery.state"}},e._l(e.states,function(e){return o("el-option",{key:e,attrs:{label:e,value:e}})})),e._v(" "),o("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchBtn}},[e._v("查询")])],1)]),e._v(" "),o("el-main",[o("div",{staticClass:"filter-container",staticStyle:{"padding-top":"0"}},[o("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addBtn}},[e._v("新增用户")]),e._v(" "),o("el-button",{staticClass:"filter-item",attrs:{type:"info",icon:"el-icon-delete"},on:{click:e.deleteBtn}},[e._v("删除")])],1),e._v(" "),o("div",[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"multipleTable",attrs:{border:"",stripe:"",data:e.tableData3,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),e._v(" "),o("el-table-column",{attrs:{prop:"loginName",label:"账号",width:"120",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"姓名",width:"120",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"mobile",label:"联系号码",width:"120",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"dept.name",label:"部门",width:"120","show-overflow-tooltip":"",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"postStateLabel",label:"状态",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text",title:"编辑"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[o("svg-icon",{attrs:{"icon-class":"editColor"}})],1),e._v(" "),o("el-button",{attrs:{type:"text",title:"修改密码"},on:{click:function(o){e.ModifyPassword(t.$index,t.row)}}},[o("svg-icon",{attrs:{"icon-class":"password1"}})],1),e._v(" "),o("el-button",{attrs:{type:"text",title:"1"==t.row.state?"启用":"停用"},on:{click:function(o){e.handleStart(t.$index,t.row)}}},[o("svg-icon",{attrs:{"icon-class":"1"==t.row.state?"remove1":"remove"}})],1)]}}])})],1),e._v(" "),o("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.pageNo,limit:e.listQuery.pageSize},on:{"update:page":function(t){e.$set(e.listQuery,"pageNo",t)},"update:limit":function(t){e.$set(e.listQuery,"pageSize",t)},pagination:e.getList}})],1)])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:e.dialogVisible,width:"40%",title:"添加用户",top:"5vh","modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px","status-icon":""}},[o("el-form-item",{attrs:{label:"单位"}},[e._v("\n        "+e._s(e.unit)+"\n      ")]),e._v(" "),o("el-form-item",{attrs:{prop:"post",label:"岗位",required:""}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.post,callback:function(t){e.$set(e.form,"post",t)},expression:"form.post"}},e._l(e.postArray,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{prop:"loginName",label:"账号",required:""}},[o("el-input",{model:{value:e.form.loginName,callback:function(t){e.$set(e.form,"loginName",t)},expression:"form.loginName"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"name",label:"姓名",required:""}},[o("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"password",label:"密码",required:""}},[o("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"checkPass",label:"确认密码",required:""}},[o("el-input",{attrs:{type:"password"},model:{value:e.form.checkPass,callback:function(t){e.$set(e.form,"checkPass",t)},expression:"form.checkPass"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"sort",label:"排序",required:""}},[o("el-input",{attrs:{type:"number"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"mobile",label:"手机号码",required:""}},[o("el-input",{attrs:{type:"text"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"gender",label:"性别"}},[o("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择性别",clearable:""},model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},[o("el-option",{attrs:{label:"男",value:"M"}}),e._v(" "),o("el-option",{attrs:{label:"女",value:"F"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{prop:"state",label:"状态",required:""}},[o("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择状态",clearable:""},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[o("el-option",{attrs:{label:"正常",value:"0"}}),e._v(" "),o("el-option",{attrs:{label:"停用",value:"1"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{prop:"email",label:"邮箱"}},[o("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:e.dialogVisible1,width:"40%",title:"用户详情",top:"5vh","modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogVisible1=t}}},[o("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px","status-icon":""}},[o("el-form-item",{attrs:{label:"单位"}},[e._v("\n        "+e._s(e.unit)+"\n        ")]),e._v(" "),o("el-form-item",{attrs:{prop:"post",label:"岗位",required:""}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.post,callback:function(t){e.$set(e.form,"post",t)},expression:"form.post"}},e._l(e.postArray,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{prop:"loginName",label:"账号",required:""}},[o("el-input",{model:{value:e.form.loginName,callback:function(t){e.$set(e.form,"loginName",t)},expression:"form.loginName"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"name",label:"姓名",required:""}},[o("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"sort",label:"排序",required:""}},[o("el-input",{attrs:{type:"number"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"mobile",label:"手机号码",required:""}},[o("el-input",{attrs:{type:"text"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"gender",label:"性别"}},[o("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择性别",clearable:""},model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},[o("el-option",{attrs:{label:"男",value:"M"}}),e._v(" "),o("el-option",{attrs:{label:"女",value:"F"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{prop:"state",label:"状态"}},[o("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择状态",clearable:""},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[o("el-option",{attrs:{label:"正常",value:"0"}}),e._v(" "),o("el-option",{attrs:{label:"停用",value:"1"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{prop:"email",label:"邮箱"}},[o("el-input",{model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogVisible1=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:e.dialogVisible2,width:"40%",title:"修改密码",top:"5vh","modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogVisible2=t}}},[o("el-form",{ref:"form2",attrs:{model:e.form2,rules:e.rules2,"label-width":"80px","status-icon":""}},[o("el-form-item",{attrs:{label:"旧密码",prop:"oldPassword"}},[o("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"请输入旧的密码"},model:{value:e.form2.oldPassword,callback:function(t){e.$set(e.form2,"oldPassword",t)},expression:"form2.oldPassword"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[o("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"请输入新的密码"},model:{value:e.form2.newPassword,callback:function(t){e.$set(e.form2,"newPassword",t)},expression:"form2.newPassword"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[o("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"请确认密码"},model:{value:e.form2.checkPass,callback:function(t){e.$set(e.form2,"checkPass",t)},expression:"form2.checkPass"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogVisible2=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.savePass}},[e._v("确 定")])],1)],1)],1)},[],!1,null,"3ba940d8",null);p.options.__file="userManagement.vue";t.default=p.exports},Nb5J:function(e,t,o){"use strict";var a=o("Q92w");o.n(a).a},Q92w:function(e,t,o){},VkuR:function(e,t,o){"use strict";var a=o("h43A");o.n(a).a},Y5bG:function(e,t,o){"use strict";o.d(t,"a",function(){return l}),Math.easeInOutQuad=function(e,t,o,a){return(e/=a/2)<1?o/2*e*e+t:-o/2*(--e*(e-2)-1)+t};var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};function l(e,t,o){var l=document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop,i=e-l,r=0;t=void 0===t?500:t;!function e(){r+=20,function(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}(Math.easeInOutQuad(r,l,i,t)),r<t?a(e):o&&"function"==typeof o&&o()}()}},h43A:function(e,t,o){},iQb1:function(e,t,o){"use strict";o.d(t,"a",function(){return l});var a=o("t3Un");function l(e){return Object(a.a)({url:"/api/sys/area/tree",method:"get",params:{pid:e}})}}}]);